<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>RDeck proxy — rdeck_proxy • rdeck</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="RDeck proxy — rdeck_proxy" />
<meta property="og:description" content="Creates an rdeck() interface for asynchronous updates of a pre-rendered rdeck map
in Shiny apps.
All rdeck props can be updated through the proxy (NULL values will be discarded),
layers that are added to the proxy (e.g. rdeck_proxy %&amp;gt;% add_h3_hexagon_layer())
will be merged with pre-rendered rdeck layers.
Layers are merged by their id. Matched layers will be updated in place, new layers
will be appended and hence drawn on top of all existing layers. For layer updates, you
may omit the data prop to avoid re-serialising unchanged data. All other props will
assume their defaults if omitted." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rdeck</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6.9300</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rdeck.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/anthonynorth/rdeck/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>RDeck proxy</h1>
    <small class="dont-index">Source: <a href='https://github.com/anthonynorth/rdeck/blob/master/R/shiny.R'><code>R/shiny.R</code></a></small>
    <div class="hidden name"><code>rdeck_proxy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates an <code><a href='rdeck.html'>rdeck()</a></code> interface for asynchronous updates of a pre-rendered rdeck map
in Shiny apps.</p>
<p>All rdeck props can be updated through the proxy (<code>NULL</code> values will be discarded),
layers that are added to the proxy (e.g. <code>rdeck_proxy %&gt;% add_h3_hexagon_layer()</code>)
will be merged with pre-rendered rdeck layers.</p>
<p>Layers are merged by their <code>id</code>. Matched layers will be updated in place, new layers
will be appended and hence drawn <em>on top</em> of all existing layers. For layer updates, you
may omit the <code>data</code> prop to avoid re-serialising unchanged data. All other props will
assume their defaults if omitted.</p>
    </div>

    <pre class="usage"><span class='fu'>rdeck_proxy</span><span class='op'>(</span>
  <span class='va'>id</span>,
  session <span class='op'>=</span> <span class='fu'>shiny</span><span class='fu'>::</span><span class='fu'><a href='https://shiny.rstudio.com/reference/shiny/latest/domains.html'>getDefaultReactiveDomain</a></span><span class='op'>(</span><span class='op'>)</span>,
  map_style <span class='op'>=</span> <span class='cn'>NULL</span>,
  theme <span class='op'>=</span> <span class='cn'>NULL</span>,
  initial_bounds <span class='op'>=</span> <span class='cn'>NULL</span>,
  initial_view_state <span class='op'>=</span> <span class='cn'>NULL</span>,
  controller <span class='op'>=</span> <span class='cn'>NULL</span>,
  picking_radius <span class='op'>=</span> <span class='cn'>NULL</span>,
  use_device_pixels <span class='op'>=</span> <span class='cn'>NULL</span>,
  blending_mode <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>id</th>
      <td><p>&lt;<code>string</code>&gt; The map id</p></td>
    </tr>
    <tr>
      <th>session</th>
      <td><p>&lt;<code>ShinySession</code>&gt; The shiny session</p></td>
    </tr>
    <tr>
      <th>map_style</th>
      <td><p>&lt;<code>string</code>&gt; The mapbox basemap style url.
See <a href='https://docs.mapbox.com/api/maps/#mapbox-styles'>https://docs.mapbox.com/api/maps/#mapbox-styles</a></p></td>
    </tr>
    <tr>
      <th>theme</th>
      <td><p>&lt;<code>"kepler"</code> | <code>"light"</code>&gt; The widget theme which alters the style of the
legend and tooltips.</p></td>
    </tr>
    <tr>
      <th>initial_bounds</th>
      <td><p>&lt;<code><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></code> | <code><a href='https://r-spatial.github.io/sf/reference/sf.html'>sf</a></code> | <code><a href='https://r-spatial.github.io/sf/reference/sfc.html'>sfc</a></code>&gt;
The initial bounds of the map; overwrites <code>initial_view_state</code>.</p></td>
    </tr>
    <tr>
      <th>initial_view_state</th>
      <td><p>&lt;<code><a href='view_state.html'>view_state</a></code>&gt; Defines the map position, zoom, bearing and pitch.</p></td>
    </tr>
    <tr>
      <th>controller</th>
      <td><p>&lt;<code>logical</code>&gt; If <code>NULL</code> or <code>FALSE</code>, the map is not interactive.</p></td>
    </tr>
    <tr>
      <th>picking_radius</th>
      <td><p>&lt;<code>number</code>&gt; Extra pixels around the pointer to include while picking;
useful when rendering objects that are difficult to hover, e.g. thin lines, small points, etc.</p></td>
    </tr>
    <tr>
      <th>use_device_pixels</th>
      <td><p>&lt;<code>logical</code> | <code>number</code>&gt; Controls the resolution of drawing buffer used
for rendering.</p><ul>
<li><p><code>TRUE</code>: Resolution is defined by <code>window.devicePixelRatio</code>. On Retina/HD displays, this
resolution is usually twice as big as <code>CSS pixels</code> resolution.</p></li>
<li><p><code>FALSE</code>: <code>CSS pixels</code> resolution is used for rendering.</p></li>
<li><p><code>number</code>: Custom ratio (drawing buffer resolution to <code>CSS pixel</code>) to determine drawing
buffer size. A value less than <code>1</code> uses resolution smaller than <code>CSS pixels</code>, improving
rendering performance at the expense of image quality; a value greater than <code>1</code> improves
image quality at the expense of rendering performance.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>blending_mode</th>
      <td><p>&lt;<code>"normal"</code> | <code>"additive"</code> | <code>"subtractive"</code>&gt; Sets the blending mode.
Blending modes:</p><ul>
<li><p><code>normal</code>: Normal blending doesn't alter colours of overlapping objects.</p></li>
<li><p><code>additive</code>: Additive blending adds colours of overlapping objects. Useful for highlighting
dot density on dark maps.</p></li>
<li><p><code>subtractive</code>: Subtractive blending darkens overlapping objects. Useful for highlighting
dot density on light maps.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters that will be forwarded to deck.gl javascript without
validation nor processing. All dots must be named and will be <code>camelCased</code> when serialised.
A warning is raised when dots are used, warning class <code>rdeck_dots_nonempty</code>.</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://shiny.rstudio.com'>shiny</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>dplyr</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>h3jsr</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>viridis</span><span class='op'>)</span>

<span class='va'>ui</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://shiny.rstudio.com/reference/shiny/latest/fillPage.html'>fillPage</a></span><span class='op'>(</span>
  <span class='fu'><a href='rdeck-shiny.html'>rdeckOutput</a></span><span class='op'>(</span><span class='st'>"map"</span>, height <span class='op'>=</span> <span class='st'>"100%"</span><span class='op'>)</span>,
  <span class='fu'><a href='https://shiny.rstudio.com/reference/shiny/latest/absolutePanel.html'>absolutePanel</a></span><span class='op'>(</span>
    top <span class='op'>=</span> <span class='fl'>10</span>, left <span class='op'>=</span> <span class='fl'>10</span>,
    <span class='fu'><a href='https://shiny.rstudio.com/reference/shiny/latest/sliderInput.html'>sliderInput</a></span><span class='op'>(</span><span class='st'>"range"</span>, <span class='st'>"value"</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, step <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>h3_data</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>
  hexagon <span class='op'>=</span> <span class='fu'>get_res0</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>get_children</span><span class='op'>(</span>res <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span>,
  value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>hexagon</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rdeck.html'>rdeck</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='h3_hexagon_layer.html'>add_h3_hexagon_layer</a></span><span class='op'>(</span>
    id <span class='op'>=</span> <span class='st'>"h3_hexagon"</span>,
    name <span class='op'>=</span> <span class='st'>"hexagons"</span>,
    data <span class='op'>=</span> <span class='va'>h3_data</span>,
    get_fill_color <span class='op'>=</span> <span class='fu'><a href='scale_quantize.html'>scale_color_quantize</a></span><span class='op'>(</span>
      col <span class='op'>=</span> <span class='va'>value</span>,
      palette <span class='op'>=</span> <span class='fu'>viridis</span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>0.3</span><span class='op'>)</span>
    <span class='op'>)</span>,
    pickable <span class='op'>=</span> <span class='cn'>TRUE</span>,
    auto_highlight <span class='op'>=</span> <span class='cn'>TRUE</span>,
    tooltip <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>hexagon</span>, <span class='va'>value</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>server</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span>, <span class='va'>output</span>, <span class='va'>session</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>output</span><span class='op'>$</span><span class='va'>map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rdeck-shiny.html'>renderRdeck</a></span><span class='op'>(</span><span class='va'>map</span><span class='op'>)</span>

  <span class='va'>filtered_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://shiny.rstudio.com/reference/shiny/latest/reactive.html'>reactive</a></span><span class='op'>(</span><span class='op'>{</span>
    <span class='va'>h3_data</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>&gt;=</span> <span class='va'>input</span><span class='op'>$</span><span class='va'>range</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>&lt;=</span> <span class='va'>input</span><span class='op'>$</span><span class='va'>range</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>

  <span class='fu'><a href='https://shiny.rstudio.com/reference/shiny/latest/observe.html'>observe</a></span><span class='op'>(</span><span class='op'>{</span>
    <span class='fu'>rdeck_proxy</span><span class='op'>(</span><span class='st'>"map"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='h3_hexagon_layer.html'>add_h3_hexagon_layer</a></span><span class='op'>(</span>
        id <span class='op'>=</span> <span class='st'>"h3_hexagon"</span>,
        name <span class='op'>=</span> <span class='st'>"hexagons"</span>,
        data <span class='op'>=</span> <span class='fu'>filtered_data</span><span class='op'>(</span><span class='op'>)</span>,
        get_fill_color <span class='op'>=</span> <span class='fu'><a href='scale_quantize.html'>scale_color_quantize</a></span><span class='op'>(</span>
          col <span class='op'>=</span> <span class='va'>value</span>,
          palette <span class='op'>=</span> <span class='fu'>cividis</span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>0.3</span><span class='op'>)</span>
        <span class='op'>)</span>,
        pickable <span class='op'>=</span> <span class='cn'>TRUE</span>,
        auto_highlight <span class='op'>=</span> <span class='cn'>TRUE</span>,
        tooltip <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>hexagon</span>, <span class='va'>value</span><span class='op'>)</span>
      <span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>app</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html'>shinyApp</a></span><span class='op'>(</span><span class='va'>ui</span>, <span class='va'>server</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anthony North.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '3ca320790448947a263a14839534e41e',
    indexName: 'rdeck',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


