!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.rdeck=t():e.rdeck=t()}(window,(function(){return function(e){function t(t){for(var r,i,c=t[0],l=t[1],u=t[2],d=0,f=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(s&&s(t);f.length;)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var l=n[c];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={0:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonprdeck=window.webpackJsonprdeck||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=l;return o.push([276,1]),n()}({141:function(e,t){},250:function(e,t,n){},268:function(e,t){},276:function(e,t,n){"use strict";n.r(t),n.d(t,"VERSION",(function(){return H})),n.d(t,"binding",(function(){return A}));var r={};n.r(r),n.d(r,"ArcLayer",(function(){return s.a})),n.d(r,"BitmapLayer",(function(){return s.b})),n.d(r,"IconLayer",(function(){return s.f})),n.d(r,"LineLayer",(function(){return s.g})),n.d(r,"PointCloudLayer",(function(){return s.i})),n.d(r,"ScatterplotLayer",(function(){return s.k})),n.d(r,"ColumnLayer",(function(){return s.c})),n.d(r,"GridCellLayer",(function(){return s.e})),n.d(r,"PathLayer",(function(){return s.h})),n.d(r,"PolygonLayer",(function(){return s.j})),n.d(r,"GeoJsonLayer",(function(){return s.d})),n.d(r,"TextLayer",(function(){return s.m})),n.d(r,"SolidPolygonLayer",(function(){return s.l})),n.d(r,"_MultiIconLayer",(function(){return s.n})),n.d(r,"ScreenGridLayer",(function(){return d.h})),n.d(r,"CPUGridLayer",(function(){return d.b})),n.d(r,"HexagonLayer",(function(){return d.g})),n.d(r,"ContourLayer",(function(){return d.c})),n.d(r,"GridLayer",(function(){return d.e})),n.d(r,"GPUGridLayer",(function(){return d.d})),n.d(r,"AGGREGATION_OPERATION",(function(){return d.a})),n.d(r,"HeatmapLayer",(function(){return d.f})),n.d(r,"_GPUGridAggregator",(function(){return d.l})),n.d(r,"_CPUAggregator",(function(){return d.k})),n.d(r,"_AggregationLayer",(function(){return d.i})),n.d(r,"_BinSorter",(function(){return d.j})),n.d(r,"GreatCircleLayer",(function(){return f.a})),n.d(r,"S2Layer",(function(){return f.e})),n.d(r,"TileLayer",(function(){return f.h})),n.d(r,"TripsLayer",(function(){return f.i})),n.d(r,"H3ClusterLayer",(function(){return f.b})),n.d(r,"H3HexagonLayer",(function(){return f.c})),n.d(r,"Tile3DLayer",(function(){return f.g})),n.d(r,"TerrainLayer",(function(){return f.f})),n.d(r,"MVTLayer",(function(){return f.d})),n.d(r,"SimpleMeshLayer",(function(){return p.b})),n.d(r,"ScenegraphLayer",(function(){return p.a}));var a=n(3),o=n.n(a),i=n(197),c=n.n(i),l=n(119),u=(n(103),n(296)),s=(n(251),n(34)),d=n(188),f=n(187),p=n(109);n(169);function m([e,t,n,r=255]){return"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(r/255,")")}var y=n(297);class g{constructor(e){var t;this.type="quantize",this.name=void 0,this.value=void 0,this.field=void 0,this.data=void 0,this.scale=void 0;const{name:n,field:r,data:a}=e;this.name=n,this.field=r,this.data=a,this.scale=Object(y.a)().domain(null!==(t=e.domain)&&void 0!==t?t:function(e){const t=Math.min.apply(void 0,e),n=Math.max.apply(void 0,e);return[t,n]}(a)).range(e.range).nice(),this.value=function(e,t){return(n,{index:r})=>{var a;return e(null!==(a=t[r])&&void 0!==a?a:void 0)}}(this.scale,a)}}const b={getHexagon:(e,{index:t,data:n})=>n.frame.hexagon[t],getHexagons:(e,{index:t,data:n})=>n.frame.hexagons[t],getS2Token:(e,{index:t,data:n})=>n.frame.token[t],getIcon:(e,{index:t,data:n})=>n.frame.icon[t],getText:(e,{index:t,data:n})=>n.frame.text[t],getPath:(e,{index:t,data:n})=>n.frame.path[t],getPolygon:(e,{index:t,data:n})=>n.frame.polygon[t],getPosition:(e,{index:t,data:n})=>n.frame.position[t],getSourcePosition:(e,{index:t,data:n})=>n.frame.sourcePosition[t],getTargetPosition:(e,{index:t,data:n})=>n.frame.targetPosition[t]};class h{constructor(e){let{type:t}=e,n=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["type"]);this.layer=void 0,this.legend=void 0;const a=Object.entries(n).filter(([e,t])=>/get.*color$/i.test(e)&&function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}(t)).map(([e,t])=>new g(Object.assign({},t,{name:e,field:t.value,data:v(n.data,t.value)}))),o=Object.fromEntries(a.map(({name:e,value:t})=>[e,t]));this.layer=new r[t](Object.assign(b,n,o)),this.legend={name:n.id||t,scales:a}}static create(e){return new h(e)}}function v(e,t){if(Array.isArray(e)&&0===e.length)return[];if("frame"in e)return e.frame[t];if("type"in e){const n=e=>{var n;return null==(n=e.properties)?void 0:n[t]};switch(e.type){case"Feature":return n(e);case"FeatureCollection":return e.features.map(n)}}throw TypeError("data type not suppported")}n(275);var x=n(86),O=n.n(x);var j=Object(a.memo)(({info:e})=>{if(null==e)return null;const{index:t,layer:n,x:r,y:a}=e,{id:i,tooltip:c,data:l}=n.props,u=null==e.object,s=u?l.frame:e.object,d=u?e=>s[e][t]:e=>s[e],f="boolean"==typeof c?Object.keys(s):[c].flat();return o.a.createElement("div",{className:O.a.tooltip,style:{transform:"translate(".concat(r,"px, ").concat(a,"px)")}},o.a.createElement("div",{className:O.a.layerName},i),o.a.createElement("table",{className:O.a.table},o.a.createElement("tbody",null,f.map(e=>o.a.createElement("tr",{key:e},o.a.createElement("td",{className:O.a.fieldName},e),o.a.createElement("td",{className:O.a.fieldValue},String(d(e))))))))}),L=n(51),N=n.n(L);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const _=({name:e,scales:t})=>o.a.createElement("div",{className:N.a.layer},o.a.createElement("div",{className:N.a.layerName},e),t.map(e=>o.a.createElement(E,k({key:e.name},e)))),E=({name:e,field:t,scale:n})=>{const r=e.replace(/^get/,"").replace(/([A-Z])/g," $1").toLowerCase();const i=/color$/i.test(e),c=Object(a.useMemo)(()=>i?n.ticks(5).map(e=>[m(n(e)),e]):[],[n,i]);return o.a.createElement("div",{className:N.a.scale},o.a.createElement("div",{className:N.a.scaleName},r),o.a.createElement("span",{className:N.a.scaleBy},"by "),o.a.createElement("span",{className:N.a.fieldName},t),i&&o.a.createElement("svg",{className:N.a.colors,height:10+14*(c.length-1)},c.map(([e,t],n)=>o.a.createElement("svg",{key:t,y:14*n},o.a.createElement("rect",{width:20,height:10,fill:e}),o.a.createElement("text",{className:N.a.tick,x:28,y:8},t)))))};var w=Object(a.memo)(({layers:e})=>o.a.createElement("div",{className:N.a.legend},e.map(e=>o.a.createElement(_,k({key:e.name},e)))));n(250);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var T=o.a.forwardRef((e,t)=>{const n=e.props,{mapboxApiAccessToken:r,mapStyle:i,mapOptions:c}=n,s=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(n,["mapboxApiAccessToken","mapStyle","mapOptions"]),[d,f]=Object(a.useMemo)(()=>{const t=e.layers.map(h.create);return[t.map(({layer:e})=>e),t.map(({legend:e})=>e)]},[e.layers]),[p,m]=G();return o.a.createElement(a.Fragment,null,o.a.createElement(u.a,P({ref:t},s,{layers:d,onHover:m}),r&&o.a.createElement(l.a,{mapboxApiAccessToken:r,mapStyle:i,mapOptions:c})),o.a.createElement(j,{info:p}),o.a.createElement(w,{layers:f}))});const G=()=>{const[e,t]=Object(a.useState)(null);return[e,Object(a.useCallback)(e=>{if(!e.picked||!(null==e?void 0:e.layer.props.tooltip))return t(null);t(e)},[])]},S={name:"rdeck",type:"output",factory(e,t,n){const r=o.a.createRef();return{get deckgl(){return r.current},renderValue({props:a,layers:i}){if(Array.isArray(a.initialBounds)){const e=new l.b({width:t,height:n}),{longitude:r,latitude:o,zoom:i}=e.fitBounds([a.initialBounds.slice(0,2),a.initialBounds.slice(2,4)]);a.initialViewState=Object.assign({},a.initialViewState,{longitude:r,latitude:o,zoom:i})}c.a.render(o.a.createElement(T,{ref:r,props:a,layers:i}),e)},resize(e,t){}}}};HTMLWidgets.widget(S);var A=S;const H="0.2.2"},51:function(e,t,n){e.exports={legend:"_2GRwBFaZmS_r1QuTD40QTb",layer:"_2H616QgG84oJauALO4hHO9","layer-name":"_3jgOYHCNA8IXEGF-GcZfp1",layerName:"_3jgOYHCNA8IXEGF-GcZfp1",scale:"_3l1IrsNNlxgYFax5dgTxAW","scale-by":"_3WPf7mzaFF4kbhkWYxmKTy",scaleBy:"_3WPf7mzaFF4kbhkWYxmKTy","scale-name":"_2wJ0XatdYfxrDgpJ3eV93G",scaleName:"_2wJ0XatdYfxrDgpJ3eV93G","field-name":"_2rWI9appKk7uHlxFw2TCK2",fieldName:"_2rWI9appKk7uHlxFw2TCK2",colors:"_2fTup3pOrDFdw_5XJV_rhr",tick:"YlPgLSlsk4JxXl1kumg6t"}},86:function(e,t,n){e.exports={tooltip:"_1o3vLW7Ljnp1RYgitRVcV7","layer-name":"_1EGHd-czbrt1MnwOIQDNjU",layerName:"_1EGHd-czbrt1MnwOIQDNjU",table:"_3xgUIUb5a3-Pb19yZND7SX","field-name":"_3V8HBKlx4eOkgGRNmc3Xmy",fieldName:"_3V8HBKlx4eOkgGRNmc3Xmy","field-value":"_2aerz5p_BktfQNNtqjZWXo",fieldValue:"_2aerz5p_BktfQNNtqjZWXo"}}})}));