!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.rdeck=t():e.rdeck=t()}(self,(function(){return(()=>{var e,t={7236:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VERSION:()=>Re,Widget:()=>ze,binding:()=>Ge,getWidgetById:()=>Be,getWidgets:()=>Fe});var r={};n.r(r),n.d(r,{AGGREGATION_OPERATION:()=>c.KM,ArcLayer:()=>l.zv,BitmapLayer:()=>l.hz,CPUGridLayer:()=>c.ab,ColumnLayer:()=>l.eJ,ContourLayer:()=>c.YY,GPUGridLayer:()=>c.ML,GeoJsonLayer:()=>l.UW,GreatCircleLayer:()=>u.GJ,GridCellLayer:()=>l.cJ,GridLayer:()=>c.mU,H3ClusterLayer:()=>u.cH,H3HexagonLayer:()=>u.bW,HeatmapLayer:()=>c.zP,HexagonLayer:()=>c.dX,IconLayer:()=>l.eE,LineLayer:()=>l.Ie,MVTLayer:()=>u.i3,PathLayer:()=>l.nr,PointCloudLayer:()=>l.U5,PolygonLayer:()=>l.dW,S2Layer:()=>u.jJ,ScatterplotLayer:()=>l.pU,ScenegraphLayer:()=>d.S,ScreenGridLayer:()=>c.p3,SimpleMeshLayer:()=>d.L,SolidPolygonLayer:()=>l.PJ,TerrainLayer:()=>u.tr,TextLayer:()=>l.AB,Tile3DLayer:()=>u.cY,TileLayer:()=>u.Im,TripsLayer:()=>u.Fw,_AggregationLayer:()=>c.Di,_BinSorter:()=>c.l0,_CPUAggregator:()=>c.oA,_GPUGridAggregator:()=>c.Wc,_MultiIconLayer:()=>l.vb,_binaryToFeature:()=>l.ip,_findIndexBinary:()=>l.Ex});n(8559);var i=n(5893),a=n(3935),s=n(7294),o=n(9010),l=n(3810),c=n(3580),u=n(4898),d=n(1864),p=n(5736);const h=[0,0,0,255];function g([e,t,n,r=255]){return`rgba(${e}, ${t}, ${n}, ${r/255})`}function y(e,t){return Array.isArray(e)?t||4!==e.length?((t=null!=t?t:[])[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=3===e.length?e[3]:255,t):e:"string"==typeof e?(function(e,t){if(7===e.length){const n=parseInt(e.substring(1),16);t[0]=Math.floor(n/65536),t[1]=Math.floor(n/256%256),t[2]=n%256,t[3]=255}else if(9===e.length){const n=parseInt(e.substring(1),16);t[0]=Math.floor(n/16777216),t[1]=Math.floor(n/65536%256),t[2]=Math.floor(n/256%256),t[3]=n%256}}(e,t=null!=t?t:[]),t):h}var m=n(4884),f=n(5128),v=n(3446),b=n(6297),j=n(7603),x=n(6602);function L(e){return null!==e&&"object"==typeof e&&"accessor"===e.type}function O(e,t){const n=function({col:e,dataType:t},n){if("highlightColor"===n)switch(t){case"table":return function(e){return({index:t,layer:n})=>y(n.props.data.frame[e][t])}(e);case"object":return function(e){return({object:t})=>y(t[e])}(e);case"geojson":return function(e){return({object:t})=>y(t.properties[e])}(e);default:throw TypeError(`${t} not supported`)}if(n.endsWith("Color"))switch(t){case"table":return function(e){return(t,{index:n,data:r,target:i})=>y(r.frame[e][n],i)}(e);case"object":return function(e){return(t,{target:n})=>y(t[e],n)}(e);case"geojson":return function(e){return(t,{target:n})=>y(t.properties[e],n)}(e);default:throw TypeError(`${t} not supported`)}switch(t){case"table":return function(e){return(t,{index:n,data:r})=>r.frame[e][n]}(e);case"object":return function(e){return t=>t[e]}(e);case"geojson":return function(e){return t=>t.properties[e]}(e);default:throw TypeError(`${t} not supported`)}}(e,t);return{...e,getData:n}}function w(e){return L(e)&&"scale"in e}function N(e,t){"palette"in e&&(e.range=e.palette.map((e=>y(e))),e.unknown=y(e.unknown));const n=function(e){switch(e.scale){case"linear":return(0,m.Z)().domain(e.domain).range(e.range).unknown(e.unknown).clamp(!0);case"power":return(0,f.ZP)().exponent(e.exponent).domain(e.domain).range(e.range).unknown(e.unknown).clamp(!0);case"log":return(0,v.Z)().base(e.base).domain(e.domain).range(e.range).unknown(e.unknown).clamp(!0);case"threshold":case"quantile":return(0,b.Z)().domain(e.domain).range(e.range).unknown(e.unknown);case"category":return(0,j.Z)().domain(e.domain).range(e.range).unknown(e.unknown);case"quantize":return(0,x.Z)().domain(e.domain).range(e.range).unknown(e.unknown);default:throw TypeError(`scale ${e.scale} not supported`)}}(e),r="highlightColor"===t?function({col:e,dataType:t},n){switch(t){case"table":return function(e,t){return({index:n,layer:r})=>{var i;return t(null!==(i=r.props.data.frame[e][n])&&void 0!==i?i:void 0)}}(e,n);case"object":return function(e,t){return({object:n})=>{var r;return t(null!==(r=n[e])&&void 0!==r?r:void 0)}}(e,n);case"geojson":return function(e,t){return({object:n})=>{var r;return t(null!==(r=n.properties[e])&&void 0!==r?r:void 0)}}(e,n);default:throw TypeError(`${t} not supported`)}}(e,n):function({col:e,dataType:t},n){switch(t){case"table":return function(e,t){return(n,{index:r,data:i})=>{var a;return t(null!==(a=i.frame[e][r])&&void 0!==a?a:void 0)}}(e,n);case"object":return function(e,t){return n=>{var r;return t(null!==(r=n[e])&&void 0!==r?r:void 0)}}(e,n);case"geojson":return function(e,t){return n=>{var r;return t(null!==(r=n.properties[e])&&void 0!==r?r:void 0)}}(e,n);default:throw TypeError(`${t} not supported`)}}(e,n);return{...e,name:t,getData:r,scaleData:n}}var _=n(1116);function k(e="normal"){switch(e){case"additive":return{[_.Z.BLEND]:!0,blendFunc:[_.Z.SRC_ALPHA,_.Z.DST_ALPHA],blendEquation:_.Z.FUNC_ADD};case"subtractive":return{[_.Z.BLEND]:!0,blendFunc:[_.Z.ONE,_.Z.ONE_MINUS_DST_COLOR,_.Z.SRC_ALPHA,_.Z.DST_ALPHA],blendEquation:[_.Z.FUNC_SUBTRACT,_.Z.FUNC_ADD]};case"normal":default:return{[_.Z.BLEND]:!0,blendFunc:[_.Z.SRC_ALPHA,_.Z.ONE_MINUS_SRC_ALPHA,_.Z.ONE,_.Z.ONE_MINUS_SRC_ALPHA],blendEquation:[_.Z.FUNC_ADD,_.Z.FUNC_ADD]}}}function C(e){return null!==e&&"object"==typeof e&&"frame"in e}function T(e){const t=function(e){return Object.entries(e.geometry).filter((([,e])=>/MULTI/.test(e))).map((([e,t])=>({name:e,type:t})))}(e);return 0===t.length?e:t.reduce(A,e)}function A(e,{name:t,type:n}){var r,i,a,s;const o=e.frame,l=Object.fromEntries(Object.entries(o).map((([e])=>[e,[]]))),c=Object.keys(e.frame).filter((e=>e!==t)),u=o[t],d=function(e){switch(e){case"MULTIPOINT":return Z;case"MULTILINESTRING":return S;case"MULTIPOLYGON":return E;default:throw TypeError(`${e} not supported`)}}(n),p=e=>{for(const t of c)l[t].push(o[t][e])},h=[];for(let n=0;n<e.length;n++){const o=u[n];if(d(o)){l[t].push(...o);for(let t=0;t<o.length;t++)p(n),h.push(null!==(i=null===(r=e.indices)||void 0===r?void 0:r[n])&&void 0!==i?i:n)}else l[t].push(o),p(n),h.push(null!==(s=null===(a=e.indices)||void 0===a?void 0:a[n])&&void 0!==s?s:n)}return{length:l[t].length,geometry:{...e.geometry,[t]:n.replace("MULTI","")},indices:h,frame:l}}function Z(e){return Array.isArray(e[0])}function S(e){return Array.isArray(e[0][0])}function E(e){return Array.isArray(e[0][0][0])}var M=n(1118),P=n(1614),D=n(8988),H=n(2734),I=n(8261),U=n(3767),G=n(6305),z=n(7180);class B extends M.Z{initializeState(){if(!function(e){return F.some((t=>e instanceof t))}(this))return;const e=this,t=e.getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:_.Z.UNSIGNED_BYTE,size:3,accessor:(t,{index:n,data:r,target:i})=>e.encodePickingColor(C(r)&&Array.isArray(r.indices)?r.indices.indexOf(r.indices[n]):n,i)}})}}const F=[P.Z,D.Z,H.Z,I.Z,U.Z,G.Z,z.Z];class R{constructor({type:e,...t}){var n;const r=Object.entries(t),i=function(e){const t=e.filter(W).map((([e,t])=>[e,y(t)])),n=e.find((([e])=>"colorRange"===e));n&&t.push([n[0],n[1].map((e=>y(e)))]);return t}(r),a=function(e){return e.filter((([,e])=>L(e))).map((([e,t])=>[e,w(t)?N(t,e):O(t,e)]))}(r);this.type=e;const s=Object.fromEntries([...r,...i,...a.map((([e,t])=>[e,t.getData])),...V(r),["updateTriggers",q(a)],["parameters",(o=t.parameters,l=t.blendingMode,{...o,...k(l)})]]);var o,l;C(s.data)&&(s.data=T(s.data),s.extensions=[new B,...null!==(n=s.extensions)&&void 0!==n?n:[]]),"TileLayer"===e&&(s.renderSubLayers=e=>{const{bbox:{west:t,south:n,east:r,north:i},x:a,y:s,z:o}=e.tile;return new p.Z({...e,data:[{z:o,x:a,y:s}],image:e.data,bounds:[t,n,r,i]})}),this.props=s,this.scales=a.filter((([,e])=>w(e))).map((([,e])=>e)),"TextLayer"===e&&"fonts"in document&&document.fonts.load(`16px ${t.fontFamily}`)}static create(e){return new R(e)}renderLayer(e){if("TripsLayer"===this.type&&void 0!==e){const t=this.props,{loopLength:n,animationSpeed:r}=t,i=n/r,a=e/1e3%i/i;t.currentTime=a*n}return new r[this.type]({...this.props})}renderLegend(){const e=this.scales.filter((e=>e.legend));return{id:this.props.id,name:this.props.name,scales:e}}renderSelector(){var e;return{id:this.props.id,groupName:this.props.groupName,name:this.props.name,visible:null===(e=this.props.visible)||void 0===e||e}}}function W([e,t]){return e.endsWith("Color")&&(Array.isArray(t)||"string"==typeof t)}function q(e){const t=e=>{const{getData:t,scaleData:n,palette:r,...i}=e;return i},n=e.map((([e,n])=>[e,t(n)]));return Object.fromEntries(n)}function V(e){return e.filter((([e])=>"getColorWeight"===e||"getElevationWeight"===e)).filter((([,e])=>null!==e&&"function"!=typeof e&&!L(e))).map((([e,t])=>[e,()=>t]))}n(6158);var Y=n(7590),$=n(170);const J="_3rdxBLth1N2ey-DR8zZS3k",X="_3a-qtBZofjlel3EyiZrLe0",Q="_3L9Gh0vaiKQ5lmrBXb1Ppa",K="_4LWuEkar5BaPjDJypGFMM",ee="_1SNUXvO9jR7Km5I-4zWVkl";function te({info:e}){if(null==e)return null;const{index:t,layer:n,x:r,y:a}=e,{name:s,tooltip:o}=n.props,l=function(e){switch(e){case"table":return(e,{index:t,data:n})=>{const r=Object.entries(n.frame).map((([e,n])=>[e,n[t]]));return Object.fromEntries(r)};case"object":return e=>null!=e?e:{};case"geojson":return e=>{var t;return null!==(t=null==e?void 0:e.properties)&&void 0!==t?t:{}};default:throw TypeError(`${e} not supported`)}}(o.dataType)(e.object,{index:t,data:n.props.data}),c=!0===o.cols?Object.keys(l):o.cols;return(0,i.jsxs)("div",Object.assign({className:J,style:{transform:`translate(${r}px, ${a}px)`}},{children:[(0,i.jsx)("div",Object.assign({className:X},{children:s}),void 0),(0,i.jsx)("table",Object.assign({className:Q},{children:(0,i.jsx)("tbody",{children:c.map((e=>{var t;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",Object.assign({className:K},{children:e}),void 0),(0,i.jsx)("td",Object.assign({className:ee},{children:String(null!==(t=l[e])&&void 0!==t?t:null)}),void 0)]},e)}))},void 0)}),void 0)]}),void 0)}var ne=n(4975);function re({props:e,layers:t}){const n=(0,s.useRef)(null),[r,a]=ie(),{mapboxApiAccessToken:l,mapStyle:c,mapOptions:u,controller:d,parameters:p,blendingMode:h,...g}=e,y={...p,...k(h)},[m,f]=(0,s.useState)(0),v=0!==t.filter((e=>"TripsLayer"===e.type)).length;ae(v,(e=>f(e)));const b=t.map((e=>e.renderLayer(m)));return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)($.Z,Object.assign({ref:n},g,{parameters:y,layers:b,onHover:a},{children:(0,i.jsx)(Y.Z,Object.assign({id:"map",controller:d,repeat:!0},{children:c&&(0,i.jsx)(o.Z3,Object.assign({reuseMaps:!0},{mapboxApiAccessToken:l,mapStyle:c,mapOptions:u}),void 0)}),void 0)}),void 0),(0,i.jsx)(te,{info:r},void 0)]},void 0)}const ie=()=>{const[e,t]=(0,s.useState)(null);return[e,(0,s.useCallback)((e=>{if(!e.picked||!e.layer.props.tooltip||e.layer instanceof ne.Z)return t(null);t(e)}),[])]},ae=(e,t)=>{const n=(0,s.useRef)(0),r=(0,s.useRef)(Date.now()),i=()=>{t(Date.now()-r.current),n.current=window.requestAnimationFrame(i)};(0,s.useEffect)((()=>{if(e)return n.current=window.requestAnimationFrame(i),()=>window.cancelAnimationFrame(n.current)}),[e])};function se(e){return e.clientHeight>0&&e.clientHeight>0?e:e.parentElement?se(e.parentElement):null}function oe(e){const t=se(e);if(e===t||null==t)return[e.clientWidth,e.clientHeight];const{width:n,height:r}=getComputedStyle(e),i=document.createElement("div");Object.assign(i.style,{width:n,height:r,display:"hidden"}),t.appendChild(i);const a=[i.clientWidth,i.clientHeight];return t.removeChild(i),a}function le(e,t){const n=new Map;for(const r of e){const e=t(r);n.has(e)?n.get(e).push(r):n.set(e,[r])}return n}function ce(...e){return e.join(" ")}const ue={kepler:"kepler",light:"light",legend:"_19x6CEViDqIUJgmzMHUO_L",layer:"_1O5QPr7CiTBczYArgl3S--","layer-name":"_1_q1TQIZ88zoNRCuCezvNi",layerName:"_1_q1TQIZ88zoNRCuCezvNi",scale:"ePCUM6mslf2Y-i0jhVFMh","scale-name":"_3YhhTqYy3O5ALWcQDpz_EK",scaleName:"_3YhhTqYy3O5ALWcQDpz_EK","scale-by":"lMTfZcYbDODR5PTtyG7HK",scaleBy:"lMTfZcYbDODR5PTtyG7HK","color-scale":"_1mPi0Qw9KZYGIt5csk3PZh",colorScale:"_1mPi0Qw9KZYGIt5csk3PZh",tick:"UU3enfH0Fz4EvQztbQYag",line:"_8tiBQbbvJsBZ-JMiVr_n9"},de=16;function pe({layers:e}){return 0===e.length?null:(0,i.jsx)("div",Object.assign({className:ue.legend},{children:e.map((e=>(0,i.jsx)(he,Object.assign({},e),e.id)))}),void 0)}function he({name:e,scales:t}){return 0===t.length?null:(0,i.jsxs)("div",Object.assign({className:ue.layer},{children:[(0,i.jsx)("div",Object.assign({className:ue.layerName},{children:e}),void 0),t.map((e=>(0,i.jsx)(ge,Object.assign({},e),e.name)))]}),void 0)}function ge(e){const t=e.name.replace(/^get/,"").replace(/([A-Z])/g," $1").toLowerCase();const n="palette"in e;const r=function(e){return"linear"===e.scale||"power"===e.scale||"log"===e.scale}(e),a=function(e){return"threshold"===e.scale||"quantile"===e.scale||"quantize"===e.scale}(e);return(0,i.jsxs)("div",Object.assign({className:ue.scale},{children:[(0,i.jsx)("div",Object.assign({className:ue.scaleName},{children:t}),void 0),(0,i.jsx)("span",Object.assign({className:ue.scaleBy},{children:"by "}),void 0),(0,i.jsx)("span",Object.assign({className:ue.fieldName},{children:e.col}),void 0),n&&r&&(0,i.jsx)(ye,Object.assign({},e),void 0),n&&a&&(0,i.jsx)(me,Object.assign({},e),void 0),n&&"category"===e.scale&&(0,i.jsx)(fe,Object.assign({},e),void 0)]}),void 0)}const ye=({ticks:e,scaleData:t})=>{const n=e.map(((e,t)=>t)).slice(1,-1),r=de*(e.length-1),a=r+10+1;return(0,i.jsxs)("svg",Object.assign({className:ue.colorScale,height:a,shapeRendering:"crispEdges"},{children:[(0,i.jsxs)("svg",Object.assign({y:5},{children:[(0,i.jsx)("image",{width:20,height:r,href:be(t),preserveAspectRatio:"none"},void 0),n.map((e=>(0,i.jsx)("line",{className:ue.line,x2:20,y1:de*e,y2:de*e},e)))]}),void 0),(0,i.jsx)(ve,{ticks:e,y:-2},void 0)]}),void 0)},me=({ticks:e,range:t})=>{const n=t.map(g),r=de*(e.length-1)+10+1;return(0,i.jsxs)("svg",Object.assign({className:ue.colorScale,height:r,shapeRendering:"crispEdges"},{children:[(0,i.jsx)("svg",Object.assign({y:5},{children:n.map(((e,t)=>(0,i.jsx)("rect",{width:20,height:de,y:t*de,fill:e},t)))}),void 0),(0,i.jsx)(ve,{ticks:e,y:-2},void 0)]}),void 0)};function fe({ticks:e,range:t,unknownTick:n,unknown:r}){const a=n?[...t,r]:t,s=n?[...e,n]:e,o=a.map(g),l=de*s.length;return(0,i.jsxs)("svg",Object.assign({className:ue.colorScale,height:l},{children:[(0,i.jsx)("svg",{children:o.map(((e,t)=>(0,i.jsx)("rect",{width:20,height:14,y:1+t*de,fill:e},t)))},void 0),(0,i.jsx)(ve,{ticks:s},void 0)]}),void 0)}function ve({ticks:e,x:t=28,y:n=0}){return(0,i.jsx)("svg",Object.assign({},{x:t,y:n},{children:e.map(((e,t)=>(0,i.jsx)("text",Object.assign({className:ue.tick,y:de*t,dy:10},{children:String(e)}),t)))}),void 0)}function be(e,t=200){const n=e.range().length,r=[...Array(n).keys()].map((e=>e/(n-1))),i=e.copy().range(r).invert,a=document.createElement("canvas"),s=a.getContext("2d");a.width=1,a.height=t;for(let n=0;n<t;n++)s.fillStyle=g(e(i(n/t))),s.fillRect(0,n,1,1);return a.toDataURL()}var je=n(148),xe=n(7188),Le=n(8267),Oe=n(1738);const we={kepler:"kepler",light:"light","control-button":"_1y2PT6G_rnI5cGmg7MqpLb",controlButton:"_1y2PT6G_rnI5cGmg7MqpLb",icon:"_3my8Y8IViXaUPdwzwuTm-H",panel:"_1gXXPWD7BhBeBruRFmiHGO","panel-header":"_1omdPuBp7rLc7PxqfXf6Nm",panelHeader:"_1omdPuBp7rLc7PxqfXf6Nm","panel-button":"_34DBuHZkU07JF4UR5ojq4A",panelButton:"_34DBuHZkU07JF4UR5ojq4A","panel-content":"QhOXCIFHLozFZVZqJnaND",panelContent:"QhOXCIFHLozFZVZqJnaND",toggle:"_3oHkITGYCO_U1YMH6fg8CV","not-visible":"_1GgWul_iNxg7sGeCqDr7H5",notVisible:"_1GgWul_iNxg7sGeCqDr7H5",label:"_3Whijri6BYzaNXYPNrXIvZ","toggles-container":"_12HGEA7F8WLWgcXp8L6Raj",togglesContainer:"_12HGEA7F8WLWgcXp8L6Raj"};function Ne({className:e,tooltip:t,onClick:n,children:r}){return(0,i.jsx)("button",Object.assign({className:e,type:"button",onClick:n,title:t},{children:r}),void 0)}function _e({layers:e,onChange:t}){const[n,r]=(0,s.useState)(!1),a=n?le(e,(e=>{var t;return null!==(t=e.groupName)&&void 0!==t?t:e.name})):null,o=(0,s.useCallback)((()=>r((e=>!e))),[]);return(0,i.jsxs)(s.Fragment,{children:[!n&&(0,i.jsx)(Ne,Object.assign({className:we.controlButton,tooltip:"Layer selector",onClick:o},{children:(0,i.jsx)(je.Z,{className:we.icon},void 0)}),void 0),n&&(0,i.jsxs)("div",Object.assign({className:we.panel},{children:[(0,i.jsx)("div",Object.assign({className:we.panelHeader},{children:(0,i.jsxs)(Ne,Object.assign({className:we.panelButton,onClick:o,tooltip:"Close"},{children:[(0,i.jsx)(je.Z,{className:we.icon},void 0),"Layers"]}),void 0)}),void 0),(0,i.jsx)("div",Object.assign({className:we.panelContent},{children:Array.from(a.entries(),(([e,n])=>(0,i.jsx)(Ce,Object.assign({},{group:e,layers:n,onChange:t}),e)))}),void 0)]}),void 0)]},void 0)}function ke({name:e,visible:t,onChange:n}){const r=t?xe.Z:null===t?Le.Z:Oe.Z,a=null==t||t?we.toggle:[we.toggle,we.notVisible].join(" ");return(0,i.jsxs)("label",Object.assign({className:a,title:e},{children:[(0,i.jsx)("input",{type:"checkbox",style:{display:"none"},checked:null!=t&&t,onChange:()=>n(!t)},void 0),(0,i.jsx)(r,{className:we.icon},void 0),(0,i.jsx)("div",Object.assign({className:we.label},{children:e}),void 0)]}),void 0)}function Ce({group:e,layers:t,onChange:n}){const r=t[0].groupName===e,a=le(t,(e=>e.name));function o(e){return t=>n(e.map((e=>({...e,visible:t}))))}const l=Array.from(a.entries(),(([e,t])=>(0,i.jsx)(ke,{name:e,visible:Te(t),onChange:o(t)},e)));return(0,i.jsxs)(s.Fragment,{children:[r&&(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(ke,{name:e,visible:Te(t),onChange:o(t)},void 0),(0,i.jsx)("div",Object.assign({className:we.togglesContainer},{children:l}),void 0)]},void 0),!r&&l]},void 0)}function Te(e){let t=e[0].visible;for(const n of e)if(n.visible!==t)return null;return t}const Ae="rdeck",Ze="Usq__wEluBO5xYes1-T4m",Se="_2DoR2U74wgVQ17cPx7iyGw",Ee="_1xXtWbFTEJw-ltt0Fu1D81";function Me({props:e,layers:t,theme:n,lazyLoad:r,layerSelector:a,onLayerVisibilityChange:l,width:c,height:u}){const{initialBounds:d,initialViewState:p,...h}=e,g=function(e,t,n,r){return(0,s.useMemo)((()=>{if(!Array.isArray(n))return r;const[i,a,s,l]=n,c=[[Math.max(-180,i),Math.max(a,-85.051129)],[Math.min(180,s),Math.min(l,85.051129)]],u=new o.DW({width:e,height:t}),{longitude:d,latitude:p,zoom:h}=u.fitBounds(c);return{...r,longitude:d,latitude:p,zoom:h}}),[n,r,e,t])}(c,u,d,p),y=t.map(R.create),m=(0,s.useRef)(null),f=function(e,t){const[n,r]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{if(t&&e.current){const t=new IntersectionObserver((e=>{r(e[0].isIntersecting)}),{threshold:0});return t.observe(e.current),()=>t.disconnect()}}),[t,e]),n}(m,r),v=!r||f;return(0,i.jsxs)("div",Object.assign({ref:m,className:ce(Ae,n)},{children:[(0,i.jsx)("div",Object.assign({className:ce(Ze,Se)},{children:a&&(0,i.jsx)(_e,{layers:y.filter((e=>e.props.visibilityToggle)).map((e=>e.renderSelector())).reverse(),onChange:l},void 0)}),void 0),v&&(0,i.jsx)(re,{props:{...h,initialViewState:g},layers:y},void 0),(0,i.jsx)("div",Object.assign({className:ce(Ze,Ee)},{children:(0,i.jsx)(pe,{layers:y.filter((e=>e.props.visible)).map((e=>e.renderLegend())).reverse()},void 0)}),void 0)]}),void 0)}var Pe,De,He,Ie=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},Ue=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};const Ge={name:"rdeck",type:"output",factory:(e,t,n)=>(0!==t&&0!==n||([t,n]=oe(e)),new ze(e,t,n))};class ze{constructor(e,t,n){Pe.set(this,void 0),De.set(this,void 0),He.set(this,void 0),this.props={blendingMode:"normal"},this.layers=[],this.theme="kepler",this.layerSelector=!0,this.lazyLoad=!1,Ie(this,Pe,e),Ie(this,De,t),Ie(this,He,n),HTMLWidgets.shinyMode&&(Shiny.addCustomMessageHandler(`${e.id}:layer`,(e=>{var t;const n=this.layers.find((t=>t.id===e.id));if(!n)return this.renderValue({layers:[...this.layers,e]});const r=this.layerSelector&&n.visibilityToggle?n.visible:e.visible,i=null!==(t=e.data)&&void 0!==t?t:n.data,a={...n,...e,visible:r,data:i},s=this.layers.map((e=>e===n?a:e));this.renderValue({layers:s})})),Shiny.addCustomMessageHandler(`${e.id}:deck`,(({props:e,theme:t,lazyLoad:n})=>{this.renderValue({props:{...this.props,...e},theme:t,lazyLoad:n})}))),this.setLayerVisibility=this.setLayerVisibility.bind(this)}renderValue({props:e,layers:t,theme:n,layerSelector:r,lazyLoad:s}){const o={props:null!=e?e:this.props,layers:null!=t?t:this.layers,theme:null!=n?n:this.theme,layerSelector:null!=r?r:this.layerSelector,lazyLoad:null!=s?s:this.lazyLoad};Object.assign(this,o),a.render((0,i.jsx)(Me,Object.assign({},o,{onLayerVisibilityChange:this.setLayerVisibility,width:Ue(this,De),height:Ue(this,He)}),void 0),Ue(this,Pe))}resize(e,t){}get id(){return Ue(this,Pe).id}setLayerVisibility(e){if(0===e.length)return;const t=this.layers.map((t=>{const n=e.find((e=>((e,t)=>{const n=e.name===t.name,r=e.groupName===t.groupName;return n&&r||null==e.name&&null!=e.groupName&&r})(e,t)&&e.visible!==t.visible));return n?{...t,visible:n.visible}:t}));this.renderValue({layers:t})}}function Be(e){var t;const n=document.getElementById(e);return null!==(t=null==n?void 0:n.htmlwidget_data_init_result)&&void 0!==t?t:null}function Fe(){return[...document.querySelectorAll(".rdeck.html-widget")].map((e=>e.htmlwidget_data_init_result)).filter((e=>e instanceof ze))}Pe=new WeakMap,De=new WeakMap,He=new WeakMap,HTMLWidgets.widget(Ge);const Re="0.4.0-dev"},842:()=>{},5440:()=>{},2479:()=>{}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={exports:{}};return t[e].call(a.exports,a,a.exports,r),a.exports}r.m=t,e=[],r.O=(t,n,i,a)=>{if(!n){var s=1/0;for(c=0;c<e.length;c++){for(var[n,i,a]=e[c],o=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(o=!1,a<s&&(s=a));o&&(e.splice(c--,1),t=i())}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,i,a]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={472:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[s,o,l]=n,c=0;for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(l)var u=l(r);for(t&&t(n);c<s.length;c++)a=s[c],r.o(e,a)&&e[a]&&e[a][0](),e[s[c]]=0;return r.O(u)},n=self.webpackChunkrdeck=self.webpackChunkrdeck||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=r.O(void 0,[486,474,619,568,688,627,811,784,899,42,324,134,667,535,745,528,378,877,596,816,485,650,394,706,683,67,14,645,806,836,96,813,451,912,261,247,590,355,953,44,538,49,639,360,825],(()=>r(7236)));return i=r.O(i)})()}));