!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.rdeck=t():e.rdeck=t()}(window,(function(){return function(e){function t(t){for(var r,c,i=t[0],l=t[1],u=t[2],d=0,f=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&f.push(a[c][0]),a[c]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(s&&s(t);f.length;)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var l=n[i];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={0:0},o=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=window.webpackJsonprdeck=window.webpackJsonprdeck||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var s=l;return o.push([279,1]),n()}({141:function(e,t){},253:function(e,t,n){},271:function(e,t){},279:function(e,t,n){"use strict";n.r(t),n.d(t,"VERSION",(function(){return F})),n.d(t,"binding",(function(){return B}));var r={};n.r(r),n.d(r,"ArcLayer",(function(){return s.a})),n.d(r,"BitmapLayer",(function(){return s.b})),n.d(r,"IconLayer",(function(){return s.f})),n.d(r,"LineLayer",(function(){return s.g})),n.d(r,"PointCloudLayer",(function(){return s.i})),n.d(r,"ScatterplotLayer",(function(){return s.k})),n.d(r,"ColumnLayer",(function(){return s.c})),n.d(r,"GridCellLayer",(function(){return s.e})),n.d(r,"PathLayer",(function(){return s.h})),n.d(r,"PolygonLayer",(function(){return s.j})),n.d(r,"GeoJsonLayer",(function(){return s.d})),n.d(r,"TextLayer",(function(){return s.m})),n.d(r,"SolidPolygonLayer",(function(){return s.l})),n.d(r,"_MultiIconLayer",(function(){return s.n})),n.d(r,"ScreenGridLayer",(function(){return d.h})),n.d(r,"CPUGridLayer",(function(){return d.b})),n.d(r,"HexagonLayer",(function(){return d.g})),n.d(r,"ContourLayer",(function(){return d.c})),n.d(r,"GridLayer",(function(){return d.e})),n.d(r,"GPUGridLayer",(function(){return d.d})),n.d(r,"AGGREGATION_OPERATION",(function(){return d.a})),n.d(r,"HeatmapLayer",(function(){return d.f})),n.d(r,"_GPUGridAggregator",(function(){return d.l})),n.d(r,"_CPUAggregator",(function(){return d.k})),n.d(r,"_AggregationLayer",(function(){return d.i})),n.d(r,"_BinSorter",(function(){return d.j})),n.d(r,"GreatCircleLayer",(function(){return f.a})),n.d(r,"S2Layer",(function(){return f.e})),n.d(r,"TileLayer",(function(){return f.h})),n.d(r,"TripsLayer",(function(){return f.i})),n.d(r,"H3ClusterLayer",(function(){return f.b})),n.d(r,"H3HexagonLayer",(function(){return f.c})),n.d(r,"Tile3DLayer",(function(){return f.g})),n.d(r,"TerrainLayer",(function(){return f.f})),n.d(r,"MVTLayer",(function(){return f.d})),n.d(r,"SimpleMeshLayer",(function(){return m.b})),n.d(r,"ScenegraphLayer",(function(){return m.a}));var a=n(3),o=n.n(a),c=n(198),i=n.n(c),l=n(120),u=(n(104),n(297)),s=(n(254),n(34)),d=n(189),f=n(188),m=n(110);n(170);function p([e,t,n,r=255]){return"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(r/255,")")}var y=n(87);class g{constructor({type:e,name:t,value:n,data:r,domain:a,range:o,exponent:c,base:i}){this.type=void 0,this.name=void 0,this.value=void 0,this.field=void 0,this.data=void 0,this.scale=void 0,this.type=e,this.name=t,this.field=n,this.data=r,this.scale=function({type:e,domain:t,range:n,exponent:r,base:a}){switch(e){case"linear":return Object(y.a)().domain(t).range(n).nice();case"power":return Object(y.c)().domain(t).range(n).exponent(r).nice();case"log":return Object(y.b)().domain(t).range(n).base(a).nice();case"quantize":return Object(y.e)().domain(t).range(n).nice();case"quantile":return Object(y.d)().domain(t).range(n);default:throw TypeError("scale type: ".concat(e," not supported"))}}({type:e,domain:null!=a?a:r,range:o,exponent:c,base:i}),this.value=function(e,t){return(n,{index:r})=>e(t[r])}(this.scale,r)}}const b={getHexagon:(e,{index:t,data:n})=>n.frame.hexagon[t],getHexagons:(e,{index:t,data:n})=>n.frame.hexagons[t],getS2Token:(e,{index:t,data:n})=>n.frame.token[t],getIcon:(e,{index:t,data:n})=>n.frame.icon[t],getText:(e,{index:t,data:n})=>n.frame.text[t],getPath:(e,{index:t,data:n})=>n.frame.path[t],getPolygon:(e,{index:t,data:n})=>n.frame.polygon[t],getPosition:(e,{index:t,data:n})=>n.frame.position[t],getSourcePosition:(e,{index:t,data:n})=>n.frame.sourcePosition[t],getTargetPosition:(e,{index:t,data:n})=>n.frame.targetPosition[t]};class h{constructor(e){let{type:t}=e,n=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["type"]);this.layer=void 0,this.legend=void 0;const a=Object.entries(n).filter(([e,t])=>/get.*color$/i.test(e)&&function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}(t)).map(([e,t])=>new g(Object.assign({},t,{name:e,data:x(n.data,t.value)}))),o=Object.fromEntries(a.map(({name:e,value:t})=>[e,t]));this.layer=new r[t](Object.assign(b,n,o)),this.legend={name:n.id||t,scales:a}}static create(e){return new h(e)}}function x(e,t){if(Array.isArray(e)&&0===e.length)return[];if("frame"in e)return e.frame[t];if("type"in e){const n=e=>{var n;return null==(n=e.properties)?void 0:n[t]};switch(e.type){case"Feature":return n(e);case"FeatureCollection":return e.features.map(n)}}throw TypeError("data type not suppported")}n(278);var v=n(86),O=n.n(v);var j=Object(a.memo)(({info:e})=>{if(null==e)return null;const{index:t,layer:n,x:r,y:a}=e,{id:c,tooltip:i,data:l}=n.props,u=null==e.object,s=u?l.frame:e.object,d=u?e=>s[e][t]:e=>s[e],f="boolean"==typeof i?Object.keys(s):[i].flat();return o.a.createElement("div",{className:O.a.tooltip,style:{transform:"translate(".concat(r,"px, ").concat(a,"px)")}},o.a.createElement("div",{className:O.a.layerName},c),o.a.createElement("table",{className:O.a.table},o.a.createElement("tbody",null,f.map(e=>o.a.createElement("tr",{key:e},o.a.createElement("td",{className:O.a.fieldName},e),o.a.createElement("td",{className:O.a.fieldValue},String(d(e))))))))}),E=n(39),k=n.n(E);function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const L=({name:e,scales:t})=>o.a.createElement("div",{className:k.a.layer},o.a.createElement("div",{className:k.a.layerName},e),t.map(e=>o.a.createElement(w,N({key:e.name},e)))),w=({name:e,field:t,scale:n})=>{const r=e.replace(/^get/,"").replace(/([A-Z])/g," $1").toLowerCase();const a=/color$/i.test(e),c="interpolate"in n;return o.a.createElement("div",{className:k.a.scale},o.a.createElement("div",{className:k.a.scaleName},r),o.a.createElement("span",{className:k.a.scaleBy},"by "),o.a.createElement("span",{className:k.a.fieldName},t),a&&!c&&o.a.createElement(_,{scale:n}),a&&c&&o.a.createElement(S,{scale:n}))},_=({scale:e})=>{const t=Object(a.useMemo)(()=>"ticks"in e?e.ticks(5).map(t=>[p(e(t)),t]):[],[e]),n=10+14*(t.length-1);return o.a.createElement("svg",{className:k.a.colorScale,height:n},t.map(([e,t],n)=>o.a.createElement("svg",{key:t,y:14*n},o.a.createElement("rect",{width:20,height:10,fill:e}),o.a.createElement("text",{className:k.a.tick,x:28,y:8},t))))},S=({scale:e})=>{const t=P("gradient"),n=Object(a.useMemo)(()=>e.ticks(6).map(t=>p(e(t))),[e]),r=Object(a.useMemo)(()=>e.ticks(6),[e]);return o.a.createElement("svg",{className:k.a.colorScale,height:80,width:"100%"},o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:t,x1:0,x2:0,y1:0,y2:1},n.map((e,t)=>o.a.createElement("stop",{key:t,offset:t/5,stopColor:e})))),o.a.createElement("rect",{width:20,height:"100%",fill:"url(#".concat(t,")")}),o.a.createElement("svg",{x:28},r.map((e,t)=>o.a.createElement("text",{key:t,className:k.a.tick,y:8+14*t},e))))},P=e=>Object(a.useMemo)(()=>"".concat(e,"-").concat(G()),[e]),G=(()=>{let e=0;return()=>e++})();var T=Object(a.memo)(({layers:e})=>o.a.createElement("div",{className:k.a.legend},e.map(e=>o.a.createElement(L,N({key:e.name},e)))));n(253);function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var H=o.a.forwardRef((e,t)=>{const n=e.props,{mapboxApiAccessToken:r,mapStyle:c,mapOptions:i}=n,s=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(n,["mapboxApiAccessToken","mapStyle","mapOptions"]),[d,f]=Object(a.useMemo)(()=>{const t=e.layers.map(h.create);return[t.map(({layer:e})=>e),t.map(({legend:e})=>e)]},[e.layers]),[m,p]=V();return o.a.createElement(a.Fragment,null,o.a.createElement(u.a,A({ref:t},s,{layers:d,onHover:p}),r&&o.a.createElement(l.a,{mapboxApiAccessToken:r,mapStyle:c,mapOptions:i})),o.a.createElement(j,{info:m}),o.a.createElement(T,{layers:f}))});const V=()=>{const[e,t]=Object(a.useState)(null);return[e,Object(a.useCallback)(e=>{if(!e.picked||!(null==e?void 0:e.layer.props.tooltip))return t(null);t(e)},[])]},C={name:"rdeck",type:"output",factory(e,t,n){const r=o.a.createRef();return{get deckgl(){return r.current},renderValue({props:a,layers:c}){if(Array.isArray(a.initialBounds)){const e=new l.b({width:t,height:n}),{longitude:r,latitude:o,zoom:c}=e.fitBounds([a.initialBounds.slice(0,2),a.initialBounds.slice(2,4)]);a.initialViewState=Object.assign({},a.initialViewState,{longitude:r,latitude:o,zoom:c})}i.a.render(o.a.createElement(H,{ref:r,props:a,layers:c}),e)},resize(e,t){}}}};HTMLWidgets.widget(C);var B=C;const F="0.2.2"},39:function(e,t,n){e.exports={legend:"_2GRwBFaZmS_r1QuTD40QTb",layer:"_2H616QgG84oJauALO4hHO9","layer-name":"_3jgOYHCNA8IXEGF-GcZfp1",layerName:"_3jgOYHCNA8IXEGF-GcZfp1",scale:"_3l1IrsNNlxgYFax5dgTxAW","scale-by":"_3WPf7mzaFF4kbhkWYxmKTy",scaleBy:"_3WPf7mzaFF4kbhkWYxmKTy","scale-name":"_2wJ0XatdYfxrDgpJ3eV93G",scaleName:"_2wJ0XatdYfxrDgpJ3eV93G","field-name":"_2rWI9appKk7uHlxFw2TCK2",fieldName:"_2rWI9appKk7uHlxFw2TCK2","color-scale":"_1SoB7VpHzrDYFxQD3QVa6E",colorScale:"_1SoB7VpHzrDYFxQD3QVa6E",tick:"YlPgLSlsk4JxXl1kumg6t"}},86:function(e,t,n){e.exports={tooltip:"_1o3vLW7Ljnp1RYgitRVcV7","layer-name":"_1EGHd-czbrt1MnwOIQDNjU",layerName:"_1EGHd-czbrt1MnwOIQDNjU",table:"_3xgUIUb5a3-Pb19yZND7SX","field-name":"_3V8HBKlx4eOkgGRNmc3Xmy",fieldName:"_3V8HBKlx4eOkgGRNmc3Xmy","field-value":"_2aerz5p_BktfQNNtqjZWXo",fieldValue:"_2aerz5p_BktfQNNtqjZWXo"}}})}));