(self.webpackChunkrdeck=self.webpackChunkrdeck||[]).push([[811],{9010:(t,e,n)=>{"use strict";n.d(e,{Z3:()=>V,DW:()=>r.DW});var o=n(2122),i=n(7294),a=n(5697),r=n(4235),s=n(1033),c=n(6156);"undefined"!=typeof window?window:n.g,void 0!==n.g?n.g:window;const l="undefined"!=typeof document?document:{},p=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function u(t){if(!t)return null;if("string"==typeof t)return t;t.toJS&&(t=t.toJS());const e={};for(const n of t.layers)e[n.id]=n;const n=t.layers.map((t=>{const n=e[t.ref];let o=null;if("interactive"in t&&(o={...t},delete o.interactive),n){o=o||{...t},delete o.ref;for(const t of p)t in n&&(o[t]=n[t])}return o||t}));return{...t,layers:n}}const h={container:a.object,gl:a.object,mapboxApiAccessToken:a.string,mapboxApiUrl:a.string,attributionControl:a.bool,preserveDrawingBuffer:a.bool,reuseMaps:a.bool,transformRequest:a.func,mapOptions:a.object,mapStyle:a.oneOfType([a.string,a.object]),preventStyleDiffing:a.bool,visible:a.bool,asyncRender:a.bool,onLoad:a.func,onError:a.func,width:a.number,height:a.number,viewState:a.object,longitude:a.number,latitude:a.number,zoom:a.number,bearing:a.number,pitch:a.number,altitude:a.number},g={container:l.body,mapboxApiAccessToken:function(){let t=null;if("undefined"!=typeof window&&window.location){const e=window.location.search.match(/access_token=([^&\/]*)/);t=e&&e[1]}t||"undefined"==typeof process||(t=t||process.env.MapboxAccessToken||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN);return t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function d(t,e="component"){t.debug&&a.checkPropTypes(h,t,"prop",e)}class m{constructor(t){if((0,c.Z)(this,"props",g),(0,c.Z)(this,"width",0),(0,c.Z)(this,"height",0),(0,c.Z)(this,"_fireLoadEvent",(()=>{this.props.onLoad({type:"load",target:this._map})})),!t.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=t.mapboxgl,m.initialized||(m.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(t)}finalize(){return this._destroy(),this}setProps(t){return this._update(this.props,t),this}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}getMap(){return this._map}_reuse(t){this._map=m.savedMap;const e=this._map.getContainer(),n=t.container;for(n.classList.add("mapboxgl-map");e.childNodes.length>0;)n.appendChild(e.childNodes[0]);this._map._container=n,m.savedMap=null,t.mapStyle&&this._map.setStyle(u(t.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}_create(t){if(t.reuseMaps&&m.savedMap)this._reuse(t);else{if(t.gl){const e=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=e,t.gl)}const e={container:t.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:u(t.mapStyle),interactive:!1,trackResize:!1,attributionControl:t.attributionControl,preserveDrawingBuffer:t.preserveDrawingBuffer};t.transformRequest&&(e.transformRequest=t.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},e,t.mapOptions)),this._map.once("load",t.onLoad),this._map.on("error",t.onError)}return this}_destroy(){this._map&&(m.savedMap?this._map.remove():(m.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}_initialize(t){d(t=Object.assign({},g,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||g.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);const{container:e}=t;Object.defineProperty(e,"offsetWidth",{get:()=>this.width}),Object.defineProperty(e,"clientWidth",{get:()=>this.width}),Object.defineProperty(e,"offsetHeight",{get:()=>this.height}),Object.defineProperty(e,"clientHeight",{get:()=>this.height});const n=this._map.getCanvas();n&&(n.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}_update(t,e){if(!this._map)return;d(e=Object.assign({},this.props,e),"Mapbox");const n=this._updateMapViewport(t,e),o=this._updateMapSize(t,e);this._updateMapStyle(t,e),e.asyncRender||!n&&!o||this.redraw(),this.props=e}_updateMapStyle(t,e){t.mapStyle!==e.mapStyle&&this._map.setStyle(u(e.mapStyle),{diff:!e.preventStyleDiffing})}_updateMapSize(t,e){const n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this._map.resize()),n}_updateMapViewport(t,e){const n=this._getViewState(t),o=this._getViewState(e),i=o.latitude!==n.latitude||o.longitude!==n.longitude||o.zoom!==n.zoom||o.pitch!==n.pitch||o.bearing!==n.bearing||o.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(o)),o.altitude!==n.altitude&&(this._map.transform.altitude=o.altitude)),i}_getViewState(t){const{longitude:e,latitude:n,zoom:o,pitch:i=0,bearing:a=0,altitude:r=1.5}=t.viewState||t;return{longitude:e,latitude:n,zoom:o,pitch:i,bearing:a,altitude:r}}_checkStyleSheet(t="0.47.0"){if(void 0!==l)try{const e=l.createElement("div");e.className="mapboxgl-map",e.style.display="none",l.body.appendChild(e);if(!("static"!==window.getComputedStyle(e).position)){const e=l.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),l.head.appendChild(e)}}catch(t){}}_viewStateToMapboxProps(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}(0,c.Z)(m,"initialized",!1),(0,c.Z)(m,"propTypes",h),(0,c.Z)(m,"defaultProps",g),(0,c.Z)(m,"savedMap",null);var f=n(6158),b=n.n(f);function y(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function w(t,e){if(t===e)return!0;if(y(t)&&y(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!w(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=1e-7}function v(t,e,n){return Math.max(e,Math.min(n,t))}function _(t,e,n){return y(t)?t.map(((t,o)=>_(t,e[o],n))):n*e+(1-n)*t}function P(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}const S={minZoom:0,maxZoom:24,minPitch:0,maxPitch:85},C=0,x=0,M=1.5;class E{constructor({width:t,height:e,latitude:n,longitude:o,zoom:i,bearing:a=x,pitch:r=C,altitude:s=M,maxZoom:c=S.maxZoom,minZoom:l=S.minZoom,maxPitch:p=S.maxPitch,minPitch:u=S.minPitch,transitionDuration:h,transitionEasing:g,transitionInterpolator:d,transitionInterruption:m,startPanLngLat:f,startZoomLngLat:b,startRotatePos:y,startBearing:w,startPitch:v,startZoom:_}){P(Number.isFinite(t),"`width` must be supplied"),P(Number.isFinite(e),"`height` must be supplied"),P(Number.isFinite(o),"`longitude` must be supplied"),P(Number.isFinite(n),"`latitude` must be supplied"),P(Number.isFinite(i),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:t,height:e,latitude:n,longitude:o,zoom:i,bearing:a,pitch:r,altitude:s,maxZoom:c,minZoom:l,maxPitch:p,minPitch:u,transitionDuration:h,transitionEasing:g,transitionInterpolator:d,transitionInterruption:m}),this._state={startPanLngLat:f,startZoomLngLat:b,startRotatePos:y,startBearing:w,startPitch:v,startZoom:_}}getViewportProps(){return this._viewportProps}getState(){return this._state}panStart({pos:t}){return this._getUpdatedMapState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this._state.startPanLngLat||this._unproject(e);if(!n)return this;const[o,i]=this._calculateNewLngLat({startPanLngLat:n,pos:t});return this._getUpdatedMapState({longitude:o,latitude:i})}panEnd(){return this._getUpdatedMapState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedMapState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:o,startBearing:i,startPitch:a}=this._state;if(!Number.isFinite(i)||!Number.isFinite(a))return this;let r;return r=t?this._calculateNewPitchAndBearing({...this._getRotationParams(t,o),startBearing:i,startPitch:a}):{bearing:i+e,pitch:a+n},this._getUpdatedMapState(r)}rotateEnd(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedMapState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){P(n>0,"`scale` must be a positive number");let{startZoom:o,startZoomLngLat:i}=this._state;Number.isFinite(o)||(o=this._viewportProps.zoom,i=this._unproject(e)||this._unproject(t)),P(i,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");const a=this._calculateNewZoom({scale:n,startZoom:o||0}),s=new r.ZP(Object.assign({},this._viewportProps,{zoom:a})),[c,l]=s.getMapCenterByLngLatPosition({lngLat:i,pos:t});return this._getUpdatedMapState({zoom:a,longitude:c,latitude:l})}zoomEnd(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}_getUpdatedMapState(t){return new E(Object.assign({},this._viewportProps,this._state,t))}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:o}=t;t.zoom=v(o,n,e);const{maxPitch:i,minPitch:a,pitch:s}=t;return t.pitch=v(s,a,i),Object.assign(t,(0,r.QA)(t)),t}_unproject(t){const e=new r.ZP(this._viewportProps);return t&&e.unproject(t)}_calculateNewLngLat({startPanLngLat:t,pos:e}){return new r.ZP(this._viewportProps).getMapCenterByLngLatPosition({lngLat:t,pos:e})}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:o}=this._viewportProps;return v(e+Math.log2(t),o,n)}_calculateNewPitchAndBearing({deltaScaleX:t,deltaScaleY:e,startBearing:n,startPitch:o}){e=v(e,-1,1);const{minPitch:i,maxPitch:a}=this._viewportProps;let r=o;return e>0?r=o+e*(a-o):e<0&&(r=o-e*(i-o)),{pitch:r,bearing:n+180*t}}_getRotationParams(t,e){const n=t[0]-e[0],o=t[1]-e[1],i=t[1],a=e[1],{width:r,height:s}=this._viewportProps,c=n/r;let l=0;return o>0?Math.abs(s-a)>5&&(l=o/(a-s)*1.2):o<0&&a>5&&(l=1-i/a),l=Math.min(1,Math.max(-1,l)),{deltaScaleX:c,deltaScaleY:l}}}const k=(0,i.createContext)({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),T=k.Provider;k.Provider=function({value:t,children:e}){const[n,o]=(0,i.useState)(null),a=(0,i.useContext)(k);return t={setMap:o,...a,map:a&&a.map||n,...t},i.createElement(T,{value:t},e)};const R=k,D="undefined"!=typeof window?i.useLayoutEffect:i.useEffect,Z="A valid API access token is required to use Mapbox data";const L={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},j=Object.assign({},m.propTypes,{width:a.oneOfType([a.number,a.string]),height:a.oneOfType([a.number,a.string]),onResize:a.func,disableTokenWarning:a.bool,visible:a.bool,className:a.string,style:a.object,visibilityConstraints:a.object}),O=Object.assign({},m.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:S});function z(){return i.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},i.createElement("h3",{key:"header"},Z),i.createElement("div",{key:"text"},"For information on setting up your basemap, read"),i.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}const N=(0,i.forwardRef)(((t,e)=>{const[n,o]=(0,i.useState)(!0),[a,c]=(0,i.useState)([0,0]),l=(0,i.useRef)(null),p=(0,i.useRef)(null),u=(0,i.useRef)(null),h=(0,i.useRef)(null),g=(0,i.useContext)(R);D((()=>{if(!N.supported())return;const e=new m({...t,mapboxgl:b(),width:a[0],height:a[1],container:p.current,onError:e=>{401===(e.error&&e.error.status||e.status)&&n&&(console.error(Z),o(!1)),t.onError(e)}});l.current=e,g&&g.setMap&&g.setMap(e.getMap());const i=new s.Z((e=>{if(e[0].contentRect){const{width:n,height:o}=e[0].contentRect;c([n,o]),t.onResize({width:n,height:o})}}));return i.observe(u.current),()=>{e.finalize(),l.current=null,i.disconnect()}}),[]),D((()=>{l.current&&l.current.setProps(Object.assign({},t,{width:a[0],height:a[1]}))}));const d=l.current&&l.current.getMap();(0,i.useImperativeHandle)(e,(()=>function(t){return{getMap:()=>t.current&&t.current.getMap(),queryRenderedFeatures:(e,n={})=>{const o=t.current&&t.current.getMap();return o&&o.queryRenderedFeatures(e,n)}}}(l)),[]);const f=(0,i.useCallback)((({target:t})=>{t===h.current&&t.scrollTo(0,0)}),[]),y=d&&i.createElement(T,{value:{...g,viewport:g.viewport||new r.ZP({...t,...t.viewState,width:a[0],height:a[1]}),map:d,container:g.container||u.current}},i.createElement("div",{key:"map-overlays",className:"overlays",ref:h,style:L,onScroll:f},t.children)),{className:w,width:v,height:_,style:P,visibilityConstraints:C}=t,x=Object.assign({position:"relative"},P,{width:v,height:_}),M=t.visible&&function(t,e=S){for(const o in e){const i=o.slice(0,3),a=(n=o.slice(3))[0].toLowerCase()+n.slice(1);if("min"===i&&t[a]<e[o])return!1;if("max"===i&&t[a]>e[o])return!1}var n;return!0}(t.viewState||t,C),E=Object.assign({},L,{visibility:M?"inherit":"hidden"});return i.createElement("div",{key:"map-container",ref:u,style:x},i.createElement("div",{key:"map-mapbox",ref:p,style:E,className:w}),y,!n&&!t.disableTokenWarning&&i.createElement(z,null))}));N.supported=()=>b()&&b().supported(),N.propTypes=j,N.defaultProps=O;const V=N,I={longitude:1,bearing:1};function A(t){return Number.isFinite(t)||Array.isArray(t)}function B(t,e,n){return function(t){return t in I}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}const F=["longitude","latitude","zoom","bearing","pitch"];class U extends class{constructor(){(0,c.Z)(this,"propNames",[])}arePropsEqual(t,e){for(const n of this.propNames||[])if(!w(t[n],e[n]))return!1;return!0}initializeProps(t,e){return{start:t,end:e}}interpolateProps(t,e,n){P(!1,"interpolateProps is not implemented")}getDuration(t,e){return e.transitionDuration}}{constructor(t={}){super(),Array.isArray(t)&&(t={transitionProps:t}),this.propNames=t.transitionProps||F,t.around&&(this.around=t.around)}initializeProps(t,e){const n={},o={};if(this.around){n.around=this.around;const i=new r.ZP(t).unproject(this.around);Object.assign(o,e,{around:new r.ZP(e).project(i),aroundLngLat:i})}for(const i of this.propNames){const a=t[i],r=e[i];P(A(a)&&A(r),"".concat(i," must be supplied for transition")),n[i]=a,o[i]=B(i,a,r)}return{start:n,end:o}}interpolateProps(t,e,n){const o={};for(const i of this.propNames)o[i]=_(t[i],e[i],n);if(e.around){const[i,a]=new r.ZP(Object.assign({},e,o)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:_(t.around,e.around,n)});o.longitude=i,o.latitude=a}return o}}const q=()=>{};const H=1,W=2,K=3,X=4,Y={transitionDuration:0,transitionEasing:t=>t,transitionInterpolator:new U,transitionInterruption:H,onTransitionStart:q,onTransitionInterrupt:q,onTransitionEnd:q,onViewportChange:q,onStateChange:q};class G{constructor(t={}){(0,c.Z)(this,"_animationFrame",null),(0,c.Z)(this,"_onTransitionFrame",(()=>{this._animationFrame=requestAnimationFrame(this._onTransitionFrame),this._updateViewport()})),this.props=null,this.onViewportChange=t.onViewportChange||q,this.onStateChange=t.onStateChange||q,this.time=t.getTime||Date.now}getViewportInTransition(){return this._animationFrame?this.state.propsInTransition:null}processViewportChange(t){const e=this.props;if(this.props=t,!e||this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){const n=Object.assign({},e),o=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===W?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===X)){const t=this.time(),e=(t-this.state.startTime)/this.state.duration;o.transitionDuration=this.state.duration-(t-this.state.startTime),o.transitionEasing=function(t,e){const n=t(e);return o=>1/(1-n)*(t(o*(1-e)+e)-n)}(this.state.easing,e),o.transitionInterpolator=n.transitionInterpolator}return o.onTransitionStart(),this._triggerTransition(n,o),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}_isTransitionInProgress(){return Boolean(this._animationFrame)}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}_shouldIgnoreViewportChange(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===K||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}_triggerTransition(t,e){P(this._isTransitionEnabled(e)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);const{transitionInterpolator:n}=e,o=n.getDuration?n.getDuration(t,e):e.transitionDuration;if(0===o)return;const i=e.transitionInterpolator.initializeProps(t,e),a={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:o,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(a)}_endTransition(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}_updateViewport(){const t=this.time(),{startTime:e,duration:n,easing:o,interpolator:i,startProps:a,endProps:r}=this.state;let s=!1,c=(t-e)/n;c>=1&&(c=1,s=!0),c=o(c);const l=i.interpolateProps(a,r,c),p=new E(Object.assign({},this.props,l));this.state.propsInTransition=p.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),s&&(this._endTransition(),this.props.onTransitionEnd())}}(0,c.Z)(G,"defaultProps",Y);var J=n(3041);const Q={transitionDuration:0},$={transitionDuration:300,transitionEasing:t=>t,transitionInterpolator:new U,transitionInterruption:H},tt=300,et=t=>1-(1-t)*(1-t),nt=["wheel"],ot=["panstart","panmove","panend"],it=["pinchstart","pinchmove","pinchend"],at=["tripanstart","tripanmove","tripanend"],rt=["doubletap"],st=["keydown"];class ct{constructor(){(0,c.Z)(this,"events",[]),(0,c.Z)(this,"scrollZoom",!0),(0,c.Z)(this,"dragPan",!0),(0,c.Z)(this,"dragRotate",!0),(0,c.Z)(this,"doubleClickZoom",!0),(0,c.Z)(this,"touchZoom",!0),(0,c.Z)(this,"touchRotate",!1),(0,c.Z)(this,"keyboard",!0),(0,c.Z)(this,"_interactionState",{isDragging:!1}),(0,c.Z)(this,"_events",{}),(0,c.Z)(this,"_setInteractionState",(t=>{Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)})),(0,c.Z)(this,"_onTransition",((t,e)=>{this.onViewportChange(t,this._interactionState,e)})),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new G({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}handleEvent(t){this.mapState=this.getMapState();const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{offsetCenter:{x:e,y:n}}=t;return[e,n]}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}updateViewport(t,e,n){const o=this.mapState instanceof E?this.mapState.getViewportProps():this.mapState,i={...t.getViewportProps(),...e},a=Object.keys(i).some((t=>o[t]!==i[t]));this._state=t.getState(),this._setInteractionState(n),a&&this.onViewportChange(i,this._interactionState,o)}getMapState(t){return new E({...this.mapStateProps,...this._state,...t})}isDragging(){return this._interactionState.isDragging}setOptions(t){const{onViewportChange:e,onStateChange:n,eventManager:o=this.eventManager,isInteractive:i=!0,scrollZoom:a=this.scrollZoom,dragPan:r=this.dragPan,dragRotate:s=this.dragRotate,doubleClickZoom:c=this.doubleClickZoom,touchZoom:l=this.touchZoom,touchRotate:p=this.touchRotate,keyboard:u=this.keyboard}=t;this.onViewportChange=e,this.onStateChange=n;const h=this.mapStateProps||{},g=h.height!==t.height||h.width!==t.width;this.mapStateProps=t,g&&(this.mapState=h,this.updateViewport(new E(t))),this._transitionManager.processViewportChange(t),this.eventManager!==o&&(this.eventManager=o,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(nt,i&&Boolean(a)),this.toggleEvents(ot,i&&Boolean(r||s)),this.toggleEvents(it,i&&Boolean(l||p)),this.toggleEvents(at,i&&Boolean(p)),this.toggleEvents(rt,i&&Boolean(c)),this.toggleEvents(st,i&&Boolean(u)),this.scrollZoom=a,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=c,this.touchZoom=l,this.touchRotate=p,this.keyboard=u}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}_onPanStart(t){const e=this.getCenter(t);this._panRotate=this.isFunctionKeyPressed(t)||t.rightButton;const n=this._panRotate?this.mapState.rotateStart({pos:e}):this.mapState.panStart({pos:e});return this.updateViewport(n,Q,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotate(t):this._onPanMove(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotateEnd(t):this._onPanMoveEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,Q,{isPanning:!0}),!0}_onPanMoveEnd(t){if(this.dragPan){const{inertia:e=tt}=this.dragPan;if(e&&t.velocity){const n=this.getCenter(t),o=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.mapState.pan({pos:o}).panEnd();return this.updateViewport(i,{...$,transitionDuration:e,transitionEasing:et},{isDragging:!1,isPanning:!0}),!0}}const e=this.mapState.panEnd();return this.updateViewport(e,null,{isDragging:!1,isPanning:!1}),!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.mapState.rotate({pos:e});return this.updateViewport(n,Q,{isRotating:!0}),!0}_onPanRotateEnd(t){if(this.dragRotate){const{inertia:e=tt}=this.dragRotate;if(e&&t.velocity){const n=this.getCenter(t),o=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.mapState.rotate({pos:o}).rotateEnd();return this.updateViewport(i,{...$,transitionDuration:e,transitionEasing:et},{isDragging:!1,isRotating:!0}),!0}}const e=this.mapState.panEnd();return this.updateViewport(e,null,{isDragging:!1,isRotating:!1}),!0}_onWheel(t){if(!this.scrollZoom)return!1;const{speed:e=.01,smooth:n=!1}=this.scrollZoom;t.preventDefault();const o=this.getCenter(t),{delta:i}=t;let a=2/(1+Math.exp(-Math.abs(i*e)));i<0&&0!==a&&(a=1/a);const r=this.mapState.zoom({pos:o,scale:a});return this.updateViewport(r,{...$,transitionInterpolator:new U({around:o}),transitionDuration:n?250:1},{isPanning:!0,isZooming:!0}),!0}_onPinchStart(t){const e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,Q,{isDragging:!0}),!0}_onPinch(t){if(!this.isDragging())return!1;if(!this.touchZoom&&!this.touchRotate)return!1;let e=this.mapState;if(this.touchZoom){const{scale:n}=t,o=this.getCenter(t);e=e.zoom({pos:o,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(e,Q,{isDragging:!0,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:Boolean(this.touchRotate)}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;if(this.touchZoom){const{inertia:e=tt}=this.touchZoom,{_lastPinchEvent:n}=this;if(e&&n&&t.scale!==n.scale){const o=this.getCenter(t);let i=this.mapState.rotateEnd();const a=Math.log2(t.scale),r=(a-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),s=Math.pow(2,a+r*e/2);return i=i.zoom({pos:o,scale:s}).zoomEnd(),this.updateViewport(i,{...$,transitionInterpolator:new U({around:o}),transitionDuration:e,transitionEasing:et},{isDragging:!1,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:!1}),this.blockEvents(e),!0}}const e=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onTriplePanStart(t){const e=this.getCenter(t),n=this.mapState.rotateStart({pos:e});return this.updateViewport(n,Q,{isDragging:!0}),!0}_onTriplePan(t){if(!this.isDragging())return!1;if(!this.touchRotate)return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.mapState.rotate({pos:e});return this.updateViewport(n,Q,{isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;if(this.touchRotate){const{inertia:e=tt}=this.touchRotate;if(e&&t.velocityY){const n=this.getCenter(t),o=[n[0],n[1]+=t.velocityY*e/2],i=this.mapState.rotate({pos:o});return this.updateViewport(i,{...$,transitionDuration:e,transitionEasing:et},{isDragging:!1,isRotating:!0}),this.blockEvents(e),!1}}const e=this.mapState.rotateEnd();return this.updateViewport(e,null,{isDragging:!1,isRotating:!1}),!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t),n=this.isFunctionKeyPressed(t),o=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(o,Object.assign({},$,{transitionInterpolator:new U({around:e})}),{isZooming:!0}),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n=2,moveSpeed:o=100,rotateSpeedX:i=15,rotateSpeedY:a=10}=this.keyboard,{mapStateProps:r}=this;let s;switch(t.srcEvent.keyCode){case 189:s=e?this.getMapState({zoom:r.zoom-Math.log2(n)-1}):this.getMapState({zoom:r.zoom-Math.log2(n)});break;case 187:s=e?this.getMapState({zoom:r.zoom+Math.log2(n)+1}):this.getMapState({zoom:r.zoom+Math.log2(n)});break;case 37:s=e?this.getMapState({bearing:r.bearing-i}):this.mapState.pan({pos:[o,0],startPos:[0,0]});break;case 39:s=e?this.getMapState({bearing:r.bearing+i}):this.mapState.pan({pos:[-o,0],startPos:[0,0]});break;case 38:s=e?this.getMapState({pitch:r.pitch+a}):this.mapState.pan({pos:[0,o],startPos:[0,0]});break;case 40:s=e?this.getMapState({pitch:r.pitch-a}):this.mapState.pan({pos:[0,-o],startPos:[0,0]});break;default:return!1}return this.updateViewport(s,$)}}const lt=Object.assign({},V.propTypes,{maxZoom:a.number,minZoom:a.number,maxPitch:a.number,minPitch:a.number,onViewStateChange:a.func,onViewportChange:a.func,onInteractionStateChange:a.func,transitionDuration:a.oneOfType([a.number,a.string]),transitionInterpolator:a.object,transitionInterruption:a.number,transitionEasing:a.func,onTransitionStart:a.func,onTransitionInterrupt:a.func,onTransitionEnd:a.func,scrollZoom:a.oneOfType([a.bool,a.object]),dragPan:a.oneOfType([a.bool,a.object]),dragRotate:a.oneOfType([a.bool,a.object]),doubleClickZoom:a.bool,touchZoom:a.oneOfType([a.bool,a.object]),touchRotate:a.oneOfType([a.bool,a.object]),keyboard:a.oneOfType([a.bool,a.object]),onHover:a.func,onClick:a.func,onDblClick:a.func,onContextMenu:a.func,onMouseDown:a.func,onMouseMove:a.func,onMouseUp:a.func,onTouchStart:a.func,onTouchMove:a.func,onTouchEnd:a.func,onMouseEnter:a.func,onMouseLeave:a.func,onMouseOut:a.func,onWheel:a.func,touchAction:a.string,eventRecognizerOptions:a.object,clickRadius:a.number,interactiveLayerIds:a.array,getCursor:a.func,controller:a.instanceOf(ct)}),pt=Object.assign({},V.defaultProps,S,G.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:t=>t.preventDefault(),scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:({isDragging:t,isHovering:e})=>t?"grabbing":e?"pointer":"grab"});function ut(t){if(t.lngLat||!t.offsetCenter)return t;const{offsetCenter:{x:e,y:n}}=t;if(!Number.isFinite(e)||!Number.isFinite(n))return t;const o=[e,n],i=new r.ZP(Object.assign({},this.props,this.props.viewState,{width:this.width,height:this.height}));return t.point=o,t.lngLat=i.unproject(o),t}function ht(t){const{map:e}=this;if(!e||!t)return null;const n={},o=this.props.clickRadius;this.props.interactiveLayerIds&&(n.layers=this.props.interactiveLayerIds);try{return e.queryRenderedFeatures(o?[[t[0]-o,t[1]+o],[t[0]+o,t[1]-o]]:t,n)}catch{return null}}function gt(t,e){const n=this.props[t];n&&n(ut.call(this,e))}function dt(t){gt.call(this,"touch"===t.pointerType?"onTouchStart":"onMouseDown",t)}function mt(t){gt.call(this,"touch"===t.pointerType?"onTouchEnd":"onMouseUp",t)}function ft(t){if(gt.call(this,"touch"===t.pointerType?"onTouchMove":"onMouseMove",t),!this.state.isDragging){const{onHover:e,interactiveLayerIds:n}=this.props;let o;t=ut.call(this,t),(n||e)&&(o=ht.call(this,t.point)),e&&(t.features=o,e(t));const i=Boolean(n&&o&&o.length>0),a=i&&!this.state.isHovering,r=!i&&this.state.isHovering;a&&gt.call(this,"onMouseEnter",t),r&&gt.call(this,"onMouseLeave",t),(a||r)&&this.setState({isHovering:i})}}function bt(t){const{onClick:e,onNativeClick:n,onDblClick:o,doubleClickZoom:i}=this.props;let a=[];const r=o||i;switch(t.type){case"anyclick":a.push(n),r||a.push(e);break;case"click":r&&a.push(e)}a=a.filter(Boolean),a.length&&((t=ut.call(this,t)).features=ht.call(this,t.point),a.forEach((e=>e(t))))}const yt=(0,i.forwardRef)(((t,e)=>{const n=(0,i.useContext)(R),a=(0,i.useMemo)((()=>t.controller||new ct),[]),r=(0,i.useMemo)((()=>new J.Q(null,{touchAction:t.touchAction,recognizerOptions:t.eventRecognizerOptions})),[]),s=(0,i.useRef)(null),c=(0,i.useRef)(null),l=(0,i.useRef)({width:0,height:0,state:{isHovering:!1,isDragging:!1}}).current;l.props=t,l.map=c.current&&c.current.getMap(),l.setState=e=>{l.state={...l.state,...e},s.current.style.cursor=t.getCursor(l.state)};let p,u,h=!0;const g=(t,e,n)=>{if(h)return void(p=[t,e,n]);const{onViewStateChange:o,onViewportChange:i}=l.props;o&&o({viewState:t,interactionState:e,oldViewState:n}),i&&i(t,e,n)};(0,i.useImperativeHandle)(e,(()=>function(t){return{getMap:t.current&&t.current.getMap,queryRenderedFeatures:t.current&&t.current.queryRenderedFeatures}}(c)),[]);const d=(0,i.useMemo)((()=>({...n,eventManager:r,container:n.container||s.current})),[n,s.current]);d.onViewportChange=g;const m=t=>{const{isDragging:e=!1}=t;if(e!==l.state.isDragging&&l.setState({isDragging:e}),h)return void(u=t);const{onInteractionStateChange:n}=l.props;n&&n(t)},f=()=>{l.width&&l.height&&a.setOptions({...l.props,...l.props.viewState,isInteractive:Boolean(l.props.onViewStateChange||l.props.onViewportChange),onViewportChange:g,onStateChange:m,eventManager:r,width:l.width,height:l.height})},b=({width:t,height:e})=>{l.width=t,l.height=e,f(),l.props.onResize({width:t,height:e})};(0,i.useEffect)((()=>(r.setElement(s.current),r.on({pointerdown:dt.bind(l),pointermove:ft.bind(l),pointerup:mt.bind(l),pointerleave:gt.bind(l,"onMouseOut"),click:bt.bind(l),anyclick:bt.bind(l),dblclick:gt.bind(l,"onDblClick"),wheel:gt.bind(l,"onWheel"),contextmenu:gt.bind(l,"onContextMenu")}),()=>{r.destroy()})),[]),D((()=>{p&&g(...p),u&&m(u)})),f();const{width:y,height:w,style:v,getCursor:_}=t,P=(0,i.useMemo)((()=>({position:"relative",...v,width:y,height:w,cursor:_(l.state)})),[v,y,w,_,l.state]);return p&&l._child||(l._child=i.createElement(T,{value:d},i.createElement("div",{key:"event-canvas",ref:s,style:P},i.createElement(V,(0,o.Z)({},t,{width:"100%",height:"100%",style:null,onResize:b,ref:c}))))),h=!1,l._child}));yt.supported=V.supported,yt.propTypes=lt,yt.defaultProps=pt;function wt(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!wt(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(const o of n){if(!e.hasOwnProperty(o))return!1;if(!wt(t[o],e[o]))return!1}return!0}return!1}const vt={type:a.string.isRequired,id:a.string};let _t=0;function Pt(t){const e=(0,i.useContext)(R),n=(0,i.useRef)({id:t.id,type:t.type}),[,o]=(0,i.useState)(0),a=(0,i.useMemo)((()=>t.id||"jsx-source-".concat(_t++)),[]),{map:r}=e;(0,i.useEffect)((()=>{if(r){const t=()=>o((t=>t+1));return r.on("styledata",t),()=>{r.off("styledata",t),requestAnimationFrame((()=>{r.style&&r.style._loaded&&r.getSource(a)&&r.removeSource(a)}))}}}),[r,a]);let s=r&&r.style&&r.getSource(a);return s?function(t,e,n){P(e.id===n.id,"source id changed"),P(e.type===n.type,"source type changed");let o="",i=0;for(const t in e)"children"===t||"id"===t||wt(n[t],e[t])||(o=t,i++);if(!i)return;const{type:a}=e;if("geojson"===a)t.setData(e.data);else if("image"===a)t.updateImage({url:e.url,coordinates:e.coordinates});else if("canvas"!==a&&"video"!==a||1!==i||"coordinates"!==o)if("vector"===a&&t.setUrl)switch(o){case"url":t.setUrl(e.url);break;case"tiles":t.setTiles(e.tiles)}else console.warn("Unable to update <Source> prop: ".concat(o));else t.setCoordinates(e.coordinates)}(s,t,n.current):s=function(t,e,n){if(t.style&&t.style._loaded){const o={...n};return delete o.id,delete o.children,t.addSource(e,o),t.getSource(e)}return null}(r,a,t),n.current=t,s&&i.Children.map(t.children,(t=>t&&(0,i.cloneElement)(t,{source:a})))||null}Pt.propTypes=vt;const St={type:a.oneOf(["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade","sky"]).isRequired,id:a.string,source:a.string,beforeId:a.string};function Ct(t,e,n,o){P(n.id===o.id,"layer id changed"),P(n.type===o.type,"layer type changed");try{!function(t,e,n,o){const{layout:i={},paint:a={},filter:r,minzoom:s,maxzoom:c,beforeId:l,...p}=n;if(l!==o.beforeId&&t.moveLayer(e,l),i!==o.layout){const n=o.layout||{};for(const o in i)wt(i[o],n[o])||t.setLayoutProperty(e,o,i[o]);for(const o in n)i.hasOwnProperty(o)||t.setLayoutProperty(e,o,void 0)}if(a!==o.paint){const n=o.paint||{};for(const o in a)wt(a[o],n[o])||t.setPaintProperty(e,o,a[o]);for(const o in n)a.hasOwnProperty(o)||t.setPaintProperty(e,o,void 0)}wt(r,o.filter)||t.setFilter(e,r),s===o.minzoom&&c===o.maxzoom||t.setLayerZoomRange(e,s,c);for(const n in p)wt(p[n],o[n])||t.setLayerProperty(e,n,p[n])}(t,e,n,o)}catch(t){console.warn(t)}}let xt=0;function Mt(t){const e=(0,i.useContext)(R),n=(0,i.useRef)({id:t.id,type:t.type}),[,o]=(0,i.useState)(0),a=(0,i.useMemo)((()=>t.id||"jsx-layer-".concat(xt++)),[]),{map:r}=e;(0,i.useEffect)((()=>{if(r){const t=()=>o((t=>t+1));return r.on("styledata",t),()=>{r.off("styledata",t),r.style&&r.style._loaded&&r.removeLayer(a)}}}),[r]);return r&&r.style&&r.getLayer(a)?Ct(r,a,t,n.current):function(t,e,n){if(t.style&&t.style._loaded){const o={...n,id:e};delete o.beforeId,t.addLayer(o,n.beforeId)}}(r,a,t),n.current=t,null}Mt.propTypes=St;const Et={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},kt={captureScroll:a.bool,captureDrag:a.bool,captureClick:a.bool,captureDoubleClick:a.bool,capturePointerMove:a.bool};function Tt(t={}){const e=(0,i.useContext)(R),n=(0,i.useRef)(null),o=(0,i.useRef)({props:t,state:{},context:e,containerRef:n}).current;return o.props=t,o.context=e,(0,i.useEffect)((()=>function(t){const e=t.containerRef.current,{eventManager:n}=t.context;if(!e||!n)return;const o={wheel:e=>{const{props:n}=t;n.captureScroll&&e.stopPropagation(),n.onScroll&&n.onScroll(e,t)},panstart:e=>{const{props:n}=t;n.captureDrag&&e.stopPropagation(),n.onDragStart&&n.onDragStart(e,t)},anyclick:e=>{const{props:n}=t;n.captureClick&&e.stopPropagation(),n.onClick&&n.onClick(e,t)},click:e=>{const{props:n}=t;n.captureClick&&e.stopPropagation(),n.onClick&&n.onClick(e,t)},dblclick:e=>{const{props:n}=t;n.captureDoubleClick&&e.stopPropagation(),n.onDoubleClick&&n.onDoubleClick(e,t)},pointermove:e=>{const{props:n}=t;n.capturePointerMove&&e.stopPropagation(),n.onPointerMove&&n.onPointerMove(e,t)}};return n.watch(o,e),()=>{n.off(o)}}(o)),[e.eventManager]),o}function Rt(t){const{instance:e}=t,{context:n,containerRef:o}=Tt(t);return e._context=n,e._containerRef=o,e._render()}class Dt extends i.PureComponent{constructor(...t){super(...t),(0,c.Z)(this,"_context",{}),(0,c.Z)(this,"_containerRef",(0,i.createRef)()),(0,c.Z)(this,"_onScroll",(t=>{})),(0,c.Z)(this,"_onDragStart",(t=>{})),(0,c.Z)(this,"_onDblClick",(t=>{})),(0,c.Z)(this,"_onClick",(t=>{})),(0,c.Z)(this,"_onPointerMove",(t=>{}))}_render(){throw new Error("_render() not implemented")}render(){return i.createElement(Rt,(0,o.Z)({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}(0,c.Z)(Dt,"propTypes",kt),(0,c.Z)(Dt,"defaultProps",Et);const Zt=Object.assign({},kt,{draggable:a.bool,onDrag:a.func,onDragEnd:a.func,onDragStart:a.func,offsetLeft:a.number,offsetTop:a.number}),Lt=Object.assign({},Et,{draggable:!1,offsetLeft:0,offsetTop:0});function jt(t){const{offsetCenter:{x:e,y:n}}=t;return[e,n]}function Ot(t,e,n,o){const i=t[0]+e[0]-n.offsetLeft,a=t[1]+e[1]-n.offsetTop;return o.viewport.unproject([i,a])}function zt(t,{props:e,callbacks:n,state:o,context:i,containerRef:a}){const{draggable:r}=e;if(!r)return;t.stopPropagation();const s=jt(t),c=function(t,e){const{center:{x:n,y:o}}=t;if(e){const t=e.getBoundingClientRect();return[t.left-n,t.top-o]}return null}(t,a.current);if(o.setDragPos(s),o.setDragOffset(c),n.onDragStart&&c){const o=Object.assign({},t);o.lngLat=Ot(s,c,e,i),n.onDragStart(o)}}function Nt(t){const{eventManager:e}=t.context;if(!e||!t.state.dragPos)return;const n={panmove:e=>function(t,{props:e,callbacks:n,state:o,context:i}){t.stopPropagation();const a=jt(t);o.setDragPos(a);const{dragOffset:r}=o;if(n.onDrag&&r){const o=Object.assign({},t);o.lngLat=Ot(a,r,e,i),n.onDrag(o)}}(e,t),panend:e=>function(t,{props:e,callbacks:n,state:o,context:i}){t.stopPropagation();const{dragPos:a,dragOffset:r}=o;if(o.setDragPos(null),o.setDragOffset(null),n.onDragEnd&&a&&r){const o=Object.assign({},t);o.lngLat=Ot(a,r,e,i),n.onDragEnd(o)}}(e,t),pancancel:e=>function(t,{state:e}){t.stopPropagation(),e.setDragPos(null),e.setDragOffset(null)}(e,t)};return e.watch(n),()=>{e.off(n)}}const Vt="undefined"!=typeof window&&window.devicePixelRatio||1,It=t=>Math.round(t*Vt)/Vt,At=(t,e,n="x")=>{if(null===t)return e;const o="x"===n?t.offsetWidth:t.offsetHeight;return It(e/100*o)/o*100},Bt=Object.assign({},Zt,{className:a.string,longitude:a.number.isRequired,latitude:a.number.isRequired}),Ft=Object.assign({},Lt,{className:""});function Ut(t){const e=function(t){const[e,n]=(0,i.useState)(null),[o,a]=(0,i.useState)(null),r=Tt({...t,onDragStart:zt});return r.callbacks=t,r.state.dragPos=e,r.state.setDragPos=n,r.state.dragOffset=o,r.state.setDragOffset=a,(0,i.useEffect)((()=>Nt(r)),[r.context.eventManager,Boolean(e)]),r}(t),{state:n,containerRef:o}=e,{children:a,className:r,draggable:s}=t,{dragPos:c}=n,[l,p]=function({props:t,state:e,context:n}){const{longitude:o,latitude:i,offsetLeft:a,offsetTop:r}=t,{dragPos:s,dragOffset:c}=e;if(s&&c)return[s[0]+c[0],s[1]+c[1]];let[l,p]=n.viewport.project([o,i]);return l+=a,p+=r,[l,p]}(e),u="translate(".concat(It(l),"px, ").concat(It(p),"px)"),h=s?c?"grabbing":"grab":"auto",g=(0,i.useMemo)((()=>{const t={position:"absolute",left:0,top:0,transform:u,cursor:h};return i.createElement("div",{className:"mapboxgl-marker ".concat(r),ref:e.containerRef,style:t},a)}),[a,r]),d=o.current;return d&&(d.style.transform=u,d.style.cursor=h),g}Ut.defaultProps=Ft,Ut.propTypes=Bt;i.memo(Ut);const qt={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},Ht=Object.keys(qt);const Wt=Object.assign({},kt,{className:a.string,longitude:a.number.isRequired,latitude:a.number.isRequired,altitude:a.number,offsetLeft:a.number,offsetTop:a.number,tipSize:a.number,closeButton:a.bool,closeOnClick:a.bool,anchor:a.oneOf(Object.keys(qt)),dynamicPosition:a.bool,sortByDepth:a.bool,onClose:a.func}),Kt=Object.assign({},Et,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:()=>{}});function Xt(t,e,n,[o,i]){const{anchor:a,dynamicPosition:r,tipSize:s}=t;return n&&r?function({x:t,y:e,width:n,height:o,selfWidth:i,selfHeight:a,anchor:r,padding:s=0}){let{x:c,y:l}=qt[r],p=e-l*a,u=p+a,h=Math.max(0,s-p)+Math.max(0,u-o+s);if(h>0){let t=l,n=h;for(l=0;l<=1;l+=.5)p=e-l*a,u=p+a,h=Math.max(0,s-p)+Math.max(0,u-o+s),h<n&&(n=h,t=l);l=t}let g=.5;.5===l&&(c=Math.floor(c),g=1);let d=t-c*i,m=d+i,f=Math.max(0,s-d)+Math.max(0,m-n+s);if(f>0){let e=c,o=f;for(c=0;c<=1;c+=g)d=t-c*i,m=d+i,f=Math.max(0,s-d)+Math.max(0,m-n+s),f<o&&(o=f,e=c);c=e}return Ht.find((t=>{const e=qt[t];return e.x===c&&e.y===l}))||r}({x:o,y:i,anchor:a,padding:s,width:e.width,height:e.height,selfWidth:n.clientWidth,selfHeight:n.clientHeight}):a}function Yt(t,{props:e,context:n}){(e.closeOnClick||"mapboxgl-popup-close-button"===t.target.className)&&(e.onClose(),n.eventManager&&n.eventManager.once("click",(t=>t.stopPropagation()),t.target))}function Gt(t){const e=(0,i.useRef)(null),n=Tt({...t,onClick:Yt}),{context:o,containerRef:a}=n,[,r]=(0,i.useState)(!1);(0,i.useEffect)((()=>{r(!0)}),[e.current]);const{viewport:s}=o,{className:c,longitude:l,latitude:p,altitude:u,tipSize:h,closeButton:g,children:d}=t,m=s.project([l,p,u]),f=Xt(t,s,e.current,m),b=function(t,e,n,[o,i,a],r){const{offsetLeft:s,offsetTop:c,sortByDepth:l}=t,p=qt[r],u=o+s,h=i+c,g=At(n,100*-p.x),d=At(n,100*-p.y,"y"),m={position:"absolute",transform:"\n      translate(".concat(g,"%, ").concat(d,"%)\n      translate(").concat(It(u),"px, ").concat(It(h),"px)\n    "),display:void 0,zIndex:void 0};return l?(a>1||a<-1||o<0||o>e.width||i<0||i>e.height?m.display="none":m.zIndex=Math.floor((1-a)/2*1e5),m):m}(t,s,a.current,m,f),y=(0,i.useCallback)((t=>!o.eventManager&&Yt(t,n)),[o.eventManager]);return i.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(f," ").concat(c),style:b,ref:a},i.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:h}}),i.createElement("div",{key:"content",ref:e,className:"mapboxgl-popup-content",onClick:y},g&&i.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button"},"×"),d))}Gt.propTypes=Wt,Gt.defaultProps=Kt;i.memo(Gt);const Jt=Object.assign({},kt,{toggleLabel:a.string,className:a.string,style:a.object,compact:a.bool,customAttribution:a.oneOfType([a.string,a.arrayOf(a.string)])}),Qt=Object.assign({},Et,{className:"",toggleLabel:"Toggle Attribution"});function $t(t){const{context:e,containerRef:n}=Tt(t),o=(0,i.useRef)(null),[a,r]=(0,i.useState)(!1);(0,i.useEffect)((()=>{let i;return e.map&&(i=function(t,e,n,o){const i=new(b().AttributionControl)(t);return i._map=e,i._container=n,i._innerContainer=o,i._updateAttributions(),i._updateEditLink(),e.on("styledata",i._updateData),e.on("sourcedata",i._updateData),i}({customAttribution:t.customAttribution},e.map,n.current,o.current)),()=>i&&function(t){t._map.off("styledata",t._updateData),t._map.off("sourcedata",t._updateData)}(i)}),[e.map]);const s=void 0===t.compact?e.viewport.width<=640:t.compact;(0,i.useEffect)((()=>{!s&&a&&r(!1)}),[s]);const c=(0,i.useCallback)((()=>r((t=>!t))),[]),l=(0,i.useMemo)((()=>({position:"absolute",...t.style})),[t.style]);return i.createElement("div",{style:l,className:t.className},i.createElement("div",{ref:n,"aria-pressed":a,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(s?"mapboxgl-compact":""," ").concat(a?"mapboxgl-compact-show":"")},i.createElement("button",{className:"mapboxgl-ctrl-attrib-button",title:t.toggleLabel,onClick:c}),i.createElement("div",{ref:o,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}$t.propTypes=Jt,$t.defaultProps=Qt;i.memo($t);const te=Object.assign({},kt,{className:a.string,style:a.object,container:a.object,label:a.string}),ee=Object.assign({},Et,{className:"",container:null,label:"Toggle fullscreen"});function ne(t){const{context:e,containerRef:n}=Tt(t),[o,a]=(0,i.useState)(!1),[r,s]=(0,i.useState)(!1),[c,p]=(0,i.useState)(null);(0,i.useEffect)((()=>{const t=new(b().FullscreenControl);p(t),s(t._checkFullscreenSupport());const e=()=>{const e=!t._fullscreen;t._fullscreen=e,a(e)};return l.addEventListener(t._fullscreenchange,e),()=>{l.removeEventListener(t._fullscreenchange,e)}}),[]);const u=(0,i.useMemo)((()=>({position:"absolute",...t.style})),[t.style]);if(!r)return null;const{className:h,label:g}=t,d=o?"shrink":"fullscreen";return i.createElement("div",{style:u,className:h},i.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},i.createElement("button",{key:d,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(d),type:"button",title:g,onClick:()=>{c&&(c._container=t.container||e.container,c._onClickFullscreen())}},i.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}ne.propTypes=te,ne.defaultProps=ee;i.memo(ne);let oe;const ie=Object.assign({},G.defaultProps,{transitionDuration:500}),ae=()=>{},re=Object.assign({},kt,{className:a.string,style:a.object,label:a.string,disabledLabel:a.string,auto:a.bool,positionOptions:a.object,fitBoundsOptions:a.object,trackUserLocation:a.bool,showUserLocation:a.bool,showAccuracyCircle:a.bool,onViewStateChange:a.func,onViewportChange:a.func,onGeolocate:a.func}),se=Object.assign({},Et,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showAccuracyCircle:!0,onGeolocate:()=>{}});function ce(t,{context:e,props:n}){const o=function(t){const e=new(b().LngLat)(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,o=e.toBounds(n);return[[o._ne.lng,o._ne.lat],[o._sw.lng,o._sw.lat]]}(t),{longitude:i,latitude:a,zoom:r}=e.viewport.fitBounds(o,n.fitBoundsOptions),s=Object.assign({},e.viewport,{longitude:i,latitude:a,zoom:r}),c=new E(s),l=Object.assign({},c.getViewportProps(),ie),p=n.onViewportChange||e.onViewportChange||ae;(n.onViewStateChange||e.onViewStateChange||ae)({viewState:l}),p(l)}function le(t){const e=Tt(t),{context:n,containerRef:o}=e,a=(0,i.useRef)(null),[r,s]=(0,i.useState)(null),[c,p]=(0,i.useState)(!1);(0,i.useEffect)((()=>{let o;return n.map&&(void 0!==oe?Promise.resolve(oe):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((t=>(oe="denied"!==t.state,oe))):(oe=Boolean(window.navigator.geolocation),Promise.resolve(oe))).then((i=>{p(i),a.current&&(o=function(t,e,n){const o=new(b().GeolocateControl)(e);o._container=l.createElement("div"),o._map={on:()=>{},_getUIString:()=>""},o._setupUI(!0),o._map=t.map,o._geolocateButton=n;const{eventManager:i}=t;return o.options.trackUserLocation&&i&&i.on("panstart",(()=>{"ACTIVE_LOCK"===o._watchState&&(o._watchState="BACKGROUND",n.classList.add("mapboxgl-ctrl-geolocate-background"),n.classList.remove("mapboxgl-ctrl-geolocate-active"))})),o.on("geolocate",e.onGeolocate),o}(n,t,a.current),o._updateCamera=t=>ce(t,e),s(o))})),()=>{o&&o._clearWatch()}}),[n.map]);const u=(0,i.useCallback)((()=>{r&&(r.options=e.props,r.trigger())}),[r]);(0,i.useEffect)((()=>{t.auto&&u()}),[r,t.auto]),(0,i.useEffect)((()=>{r&&r._onZoom()}),[n.viewport.zoom]);const{className:h,label:g,disabledLabel:d,trackUserLocation:m}=t,f=(0,i.useMemo)((()=>({position:"absolute",...t.style})),[t.style]);return i.createElement("div",{style:f,className:h},i.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:o},i.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:a,disabled:!c,"aria-pressed":!m,type:"button",title:c?g:d,"aria-label":c?g:d,onClick:u},i.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}le.propTypes=re,le.defaultProps=se;i.memo(le);const pe=()=>{},ue=Object.assign({},kt,{className:a.string,style:a.object,onViewStateChange:a.func,onViewportChange:a.func,showCompass:a.bool,showZoom:a.bool,zoomInLabel:a.string,zoomOutLabel:a.string,compassLabel:a.string}),he=Object.assign({},Et,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function ge(t){return function(t,e){const n=(t||"").split(".").map(Number),o=(e||"").split(".").map(Number);for(let t=0;t<3;t++){const e=n[t]||0,i=o[t]||0;if(e<i)return-1;if(e>i)return 1}return 0}(t,"1.6.0")>=0?2:1}function de(t,e,n){const{viewport:o}=t,i=new E(Object.assign({},o,n)),a=Object.assign({},i.getViewportProps(),$),r=e.onViewportChange||t.onViewportChange||pe;(e.onViewStateChange||t.onViewStateChange||pe)({viewState:a}),r(a)}function me(t,e,n,o){return i.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},o||i.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function fe(t){const{context:e,containerRef:n}=Tt(t),{className:o,showCompass:a,showZoom:r,zoomInLabel:s,zoomOutLabel:c,compassLabel:l}=t,p=(0,i.useMemo)((()=>({position:"absolute",...t.style})),[t.style]);return i.createElement("div",{style:p,className:o},i.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},r&&me("zoom-in",s,(()=>{de(e,t,{zoom:e.viewport.zoom+1})})),r&&me("zoom-out",c,(()=>{de(e,t,{zoom:e.viewport.zoom-1})})),a&&me("compass",l,(()=>{de(e,t,{bearing:0,pitch:0})}),function(t){const e=(0,i.useMemo)((()=>t.map?ge(t.map.version):2),[t.map]),{bearing:n}=t.viewport,o={transform:"rotate(".concat(-n,"deg)")};return 2===e?i.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:o}):i.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:o})}(e))))}fe.propTypes=ue,fe.defaultProps=he;i.memo(fe);const be=Object.assign({},kt,{className:a.string,style:a.object,maxWidth:a.number,unit:a.oneOf(["imperial","metric","nautical"])}),ye=Object.assign({},Et,{className:"",maxWidth:100,unit:"metric"});function we(t){const{context:e,containerRef:n}=Tt(t),[o,a]=(0,i.useState)(null);(0,i.useEffect)((()=>{if(e.map){const t=new(b().ScaleControl);t._map=e.map,t._container=n.current,a(t)}}),[e.map]),o&&(o.options=t,o._onMove());const r=(0,i.useMemo)((()=>({position:"absolute",...t.style})),[t.style]);return i.createElement("div",{style:r,className:t.className},i.createElement("div",{ref:n,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}we.propTypes=be,we.defaultProps=ye;i.memo(we);const ve="undefined"!=typeof window&&window.devicePixelRatio||1,_e=Object.assign({},kt,{redraw:a.func.isRequired});function Pe(t){const{context:e,containerRef:n}=Tt(t),[o,a]=(0,i.useState)(null);(0,i.useEffect)((()=>{a(n.current.getContext("2d"))}),[]);const{viewport:r,isDragging:s}=e;return o&&(o.save(),o.scale(ve,ve),t.redraw({width:r.width,height:r.height,ctx:o,isDragging:s,project:r.project,unproject:r.unproject}),o.restore()),i.createElement("canvas",{ref:n,width:r.width*ve,height:r.height*ve,style:{width:"".concat(r.width,"px"),height:"".concat(r.height,"px"),position:"absolute",left:0,top:0}})}Pe.propTypes=_e,Pe.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};const Se=Object.assign({},kt,{redraw:a.func.isRequired,style:a.object});function Ce(t){const{context:e,containerRef:n}=Tt(t),{viewport:o,isDragging:a}=e,r={position:"absolute",left:0,top:0,width:o.width,height:o.height,...t.style};return i.createElement("div",{ref:n,style:r},t.redraw({width:o.width,height:o.height,isDragging:a,project:o.project,unproject:o.unproject}))}Ce.propTypes=Se,Ce.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};const xe=Object.assign({},kt,{redraw:a.func.isRequired,style:a.object});function Me(t){const{context:e,containerRef:n}=Tt(t),{viewport:o,isDragging:a}=e,r={position:"absolute",left:0,top:0,...t.style};return i.createElement("svg",{width:o.width,height:o.height,ref:n,style:r},t.redraw({width:o.width,height:o.height,isDragging:a,project:o.project,unproject:o.unproject}))}Me.propTypes=xe,Me.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};b()&&b().setRTLTextPlugin}}]);